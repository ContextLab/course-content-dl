
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial 1: PyTorch &#8212; Neuromatch Academy: Deep Learning (Experimental)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../../_static/nma-dl-logo-square-4xp.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Linear Deep Learning" href="../../W1D2_LinearDeepLearning/chapter_title.html" />
    <link rel="prev" title="Basics And Pytorch" href="../chapter_title.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/nma-dl-logo-square-4xp.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neuromatch Academy: Deep Learning (Experimental)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using Discord
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../prereqs/DeepLearning.html">
   Prerequisites and preparatory materials for NMA Deep Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Basics Module
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../chapter_title.html">
   Basics And Pytorch (W1D1)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Tutorial 1: PyTorch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
   Linear Deep Learning (W1D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial1.html">
     Tutorial 1: Gradient Descent and AutoGrad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial2.html">
     Tutorial 2: Learning Hyperparameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial3.html">
     Tutorial 3: Deep linear neural networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_BonusLecture.html">
     Bonus Lecture: Yoshua Bengio
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
   Multi Layer Perceptrons (W1D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/student/W1D3_Tutorial1.html">
     Tutorial 1: Biological vs. Artificial Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/student/W1D3_Tutorial2.html">
     Tutorial 2: Deep MLPs
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Fine Tuning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D5_Optimization/chapter_title.html">
   Optimization (W1D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_Optimization/student/W1D5_Tutorial1.html">
     Tutorial 1: Optimization techniques
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D1_Regularization/chapter_title.html">
   Regularization (W2D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_Regularization/student/W2D1_Tutorial1.html">
     Tutorial 1: Regularization techniques part 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_Regularization/student/W2D1_Tutorial2.html">
     Tutorial 2: Regularization techniques part 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Module_WrapUps/FineTuning.html">
   Deep Learning: The Basics and Fine Tuning Wrap-up
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  ConvNets and Generative Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
   Convnets And Dl Thinking (W2D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_Tutorial1.html">
     Tutorial 1: Introduction to CNNs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_Tutorial2.html">
     Tutorial 2: Deep Learning Thinking 1: Cost Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_BonusLecture.html">
     Bonus Lecture: Kyunghyun Cho
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D3_ModernConvnets/chapter_title.html">
   Modern Convnets (W2D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_ModernConvnets/student/W2D3_Tutorial1.html">
     Tutorial 1: Learn how to use modern convnets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_ModernConvnets/student/W2D3_Tutorial2.html">
     Bonus Tutorial: Facial recognition using modern convnets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D4_GenerativeModels/chapter_title.html">
   Generative Models (W2D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_Tutorial1.html">
     Tutorial 1: Variational Autoencoders (VAEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_Tutorial2.html">
     Tutorial 2: Diffusion models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_Tutorial3.html">
     Tutorial 3: Image, Conditional Diffusion and Beyond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_BonusLecture.html">
     Bonus Lecture: Geoffrey Hinton
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Natural Language Processing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D5_AttentionAndTransformers/chapter_title.html">
   Attention And Transformers (W2D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D5_AttentionAndTransformers/student/W2D5_Tutorial1.html">
     Tutorial 1: Learn how to work with Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D5_AttentionAndTransformers/student/W2D5_Tutorial2.html">
     Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
   Time Series And Natural Language Processing (W3D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/student/W3D1_Tutorial1.html">
     Tutorial 1: Introduction to processing time series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/student/W3D1_Tutorial2.html">
     Tutorial 2: Natural Language Processing and LLMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/student/W3D1_Tutorial3.html">
     Bonus Tutorial: Multilingual Embeddings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D2_DlThinking2/chapter_title.html">
   Dl Thinking2 (W3D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_DlThinking2/student/W3D2_Tutorial1.html">
     Tutorial 1: Deep Learning Thinking 2: Architectures and Multimodal DL thinking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">
   Deep Learning: Convnets and NLP
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Unsupervised and Reinforcement Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
   Unsupervised And Self Supervised Learning (W3D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/student/W3D3_Tutorial1.html">
     Tutorial 1: Un/Self-supervised learning methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/student/W3D3_BonusLecture.html">
     Bonus Lecture: Melanie Mitchell
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
   Basic Reinforcement Learning (W3D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_Tutorial1.html">
     Tutorial 1: Basic Reinforcement Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_BonusLecture.html">
     Bonus Lecture: Chealsea Finn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">
   Reinforcement Learning For Games And Dl Thinking3 (W3D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_Tutorial1.html">
     Tutorial 1: Reinforcement Learning For Games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_Tutorial2.html">
     Tutorial 2: Deep Learning Thinking 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_Tutorial3.html">
     Bonus Tutorial: Planning with Monte Carlo Tree Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_BonusLecture.html">
     Bonus Lecture: Amita Kapoor
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Deploy Models on the Web
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Bonus_DeployModels/chapter_title.html">
   Deploy Models (Bonus)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Bonus_DeployModels/student/Bonus_Tutorial1.html">
     Bonus Tutorial: Deploying Neural Networks on the Web
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/README.html">
   Introduction to projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through2_DL.html">
     Modeling Steps 1 - 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_3through4_DL.html">
     Modeling Steps 3 - 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through6_DL.html">
     Modeling Steps 5 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_7through9_DL.html">
     Modeling Steps 7 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_10_DL.html">
     Modeling Steps 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProjectDL.html">
     Example Data Project: the Train Illusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModelingProjectDL.html">
     Example Model Project: the Train Illusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/Example_Deep_Learning_Project.html">
     Example Deep Learning Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../projects/docs/projects_overview.html">
   Project Templates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/ComputerVision/README.html">
     Computer Vision
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/em_synapses.html">
       Knowledge Extraction from a Convolutional Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/spectrogram_analysis.html">
       Music classification and generation with spectrograms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/screws.html">
       Something Screwy - image recognition, detection, and classification of screws
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/data_augmentation.html">
       Data Augmentation in image classification models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/transfer_learning.html">
       Transfer Learning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/ReinforcementLearning/README.html">
     Reinforcement Learning
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/robolympics.html">
       NMA Robolympics: Controlling robots using reinforcement learning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/lunar_lander.html">
       Performance Analysis of DQN Algorithm on the Lunar Lander task
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/human_rl.html">
       Using RL to Model Cognitive Tasks
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/README.html">
     Natural Language Processing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/sentiment_analysis.html">
       Twitter Sentiment Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/machine_translation.html">
       Machine Translation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/Neuroscience/README.html">
     Neuroscience
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/pose_estimation.html">
       Animal Pose Estimation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/cellular_segmentation.html">
       Segmentation and Denoising
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/algonauts_videos.html">
       Load algonauts videos
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/blurry_vision.html">
       Vision with Lost Glasses: Modelling how the brain deals with noisy input
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/finetuning_fmri.html">
       Moving beyond Labels: Finetuning CNNs on BOLD response
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/neuro_seq_to_seq.html">
       Focus on what matters: inferring low-dimensional dynamics from neural recordings
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/docs/datasets_and_models.html">
   Models and Data sets
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ContextLab/course-content-dl"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ContextLab/course-content-dl/issues/new?title=Issue%20on%20page%20%2Ftutorials/W1D1_BasicsAndPytorch/student/W1D1_Tutorial1.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/tutorials/W1D1_BasicsAndPytorch/student/W1D1_Tutorial1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Tutorial 1: PyTorch
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-welcome-to-neuromatch-deep-learning-course">
   Section 1: Welcome to Neuromatch Deep learning course
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-1-welcome-and-history">
     Video 1: Welcome and History
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-2-why-dl-is-cool">
     Video 2: Why DL is cool
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Submit your feedback
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-the-basics-of-pytorch">
   Section 2: The Basics of PyTorch
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-1-creating-tensors">
     Section 2.1: Creating Tensors
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-3-making-tensors">
       Video 3: Making Tensors
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numpy-like-number-ranges">
     <strong>
      Numpy-like number ranges:
     </strong>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-1-creating-tensors">
       Coding Exercise 2.1: Creating Tensors
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-2-operations-in-pytorch">
     Section 2.2: Operations in PyTorch
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-4-tensor-operators">
       Video 4: Tensor Operators
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-2-simple-tensor-operations">
       Coding Exercise 2.2 : Simple tensor operations
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-3-manipulating-tensors-in-pytorch">
     Section 2.3 Manipulating Tensors in Pytorch
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-5-tensor-indexing">
       Video 5: Tensor Indexing
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-3-manipulating-tensors">
       Coding Exercise 2.3: Manipulating Tensors
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-4-gpus">
     Section 2.4: GPUs
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-6-gpu-vs-cpu">
       Video 6: GPU vs CPU
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-4-just-how-much-faster-are-gpus">
       Coding Exercise 2.4: Just how much faster are GPUs?
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id9">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id10">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-5-datasets-and-dataloaders">
     Section 2.5: Datasets and Dataloaders
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-7-getting-data">
       Video 7: Getting Data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-5-display-an-image-from-the-dataset">
       Coding Exercise 2.5: Display an image from the dataset
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id12">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#video-8-train-and-test">
         Video 8: Train and Test
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id13">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#video-9-data-augmentation-transformations">
         Video 9: Data Augmentation - Transformations
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-6-load-the-cifar10-dataset-as-grayscale-images">
       Coding Exercise 2.6: Load the CIFAR10 dataset as grayscale images
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id14">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-3-neural-networks">
   Section 3: Neural Networks
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-10-csv-files">
     Video 10: CSV Files
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-1-data-loading">
     Section 3.1: Data Loading
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generate-sample-data">
       Generate sample data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-2-create-a-simple-neural-network">
     Section 3.2: Create a Simple Neural Network
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-11-generating-the-neural-network">
       Video 11: Generating the Neural Network
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-3-2-classify-some-samples">
       Coding Exercise 3.2: Classify some samples
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id17">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-3-train-your-neural-network">
     Section 3.3: Train Your Neural Network
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-12-train-the-network">
       Video 12: Train the Network
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#helper-function-to-plot-the-decision-boundary">
       Helper function to plot the decision boundary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualize-the-training-process">
       Visualize the training process
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-13-play-with-it">
       Video 13: Play with it
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-3-3-tweak-your-network">
       Exercise 3.3: Tweak your Network
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id20">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#video-14-xor-widget">
         Video 14: XOR Widget
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id21">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-3-3-solving-xor">
       Interactive Demo 3.3: Solving XOR
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id22">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-4-ethics-and-course-info">
   Section 4: Ethics And Course Info
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-15-ethics">
     Video 15: Ethics
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id23">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-16-be-a-group">
     Video 16: Be a group
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id24">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-17-syllabus">
     Video 17: Syllabus
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id25">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#meet-our-lecturers">
     Meet our lecturers
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#week-1-the-building-blocks">
       Week 1: the building blocks
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#week-2-making-things-work">
       Week 2: making things work
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#week-3-more-magic">
       Week 3: more magic
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#daily-survey">
   Daily survey
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-60-years-of-machine-learning-research-in-one-plot">
   Bonus - 60 years of Machine Learning Research in one Plot
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-altair-and-vega-datasets">
     Install and Import
     <code class="docutils literal notranslate">
      <span class="pre">
       altair
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       vega_datasets
      </span>
     </code>
     .
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-visualization-using-altair">
     Define Visualization using ALtair
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#questions">
     Questions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id26">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#methods">
     Methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-authors">
       Find Authors
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#edit-the-author-filter-variable-to-full-text-search-for-authors">
         Edit the
         <code class="docutils literal notranslate">
          <span class="pre">
           AUTHOR_FILTER
          </span>
         </code>
         variable to full text search for authors.
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix">
   Appendix
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#official-pytorch-resources">
     Official PyTorch resources:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tutorials">
       Tutorials
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#documentation">
       Documentation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#google-colab-resources">
     Google Colab Resources:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#books-for-reference">
     Books for reference:
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Tutorial 1: PyTorch</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Tutorial 1: PyTorch
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-welcome-to-neuromatch-deep-learning-course">
   Section 1: Welcome to Neuromatch Deep learning course
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-1-welcome-and-history">
     Video 1: Welcome and History
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-2-why-dl-is-cool">
     Video 2: Why DL is cool
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Submit your feedback
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-the-basics-of-pytorch">
   Section 2: The Basics of PyTorch
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-1-creating-tensors">
     Section 2.1: Creating Tensors
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-3-making-tensors">
       Video 3: Making Tensors
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numpy-like-number-ranges">
     <strong>
      Numpy-like number ranges:
     </strong>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-1-creating-tensors">
       Coding Exercise 2.1: Creating Tensors
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-2-operations-in-pytorch">
     Section 2.2: Operations in PyTorch
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-4-tensor-operators">
       Video 4: Tensor Operators
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-2-simple-tensor-operations">
       Coding Exercise 2.2 : Simple tensor operations
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-3-manipulating-tensors-in-pytorch">
     Section 2.3 Manipulating Tensors in Pytorch
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-5-tensor-indexing">
       Video 5: Tensor Indexing
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-3-manipulating-tensors">
       Coding Exercise 2.3: Manipulating Tensors
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-4-gpus">
     Section 2.4: GPUs
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-6-gpu-vs-cpu">
       Video 6: GPU vs CPU
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-4-just-how-much-faster-are-gpus">
       Coding Exercise 2.4: Just how much faster are GPUs?
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id9">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id10">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-2-5-datasets-and-dataloaders">
     Section 2.5: Datasets and Dataloaders
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-7-getting-data">
       Video 7: Getting Data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-5-display-an-image-from-the-dataset">
       Coding Exercise 2.5: Display an image from the dataset
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id12">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#video-8-train-and-test">
         Video 8: Train and Test
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id13">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#video-9-data-augmentation-transformations">
         Video 9: Data Augmentation - Transformations
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-2-6-load-the-cifar10-dataset-as-grayscale-images">
       Coding Exercise 2.6: Load the CIFAR10 dataset as grayscale images
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id14">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-3-neural-networks">
   Section 3: Neural Networks
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-10-csv-files">
     Video 10: CSV Files
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-1-data-loading">
     Section 3.1: Data Loading
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generate-sample-data">
       Generate sample data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-2-create-a-simple-neural-network">
     Section 3.2: Create a Simple Neural Network
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-11-generating-the-neural-network">
       Video 11: Generating the Neural Network
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coding-exercise-3-2-classify-some-samples">
       Coding Exercise 3.2: Classify some samples
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id17">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#section-3-3-train-your-neural-network">
     Section 3.3: Train Your Neural Network
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-12-train-the-network">
       Video 12: Train the Network
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#helper-function-to-plot-the-decision-boundary">
       Helper function to plot the decision boundary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualize-the-training-process">
       Visualize the training process
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#video-13-play-with-it">
       Video 13: Play with it
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-3-3-tweak-your-network">
       Exercise 3.3: Tweak your Network
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id20">
         Submit your feedback
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#video-14-xor-widget">
         Video 14: XOR Widget
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id21">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-3-3-solving-xor">
       Interactive Demo 3.3: Solving XOR
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id22">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-4-ethics-and-course-info">
   Section 4: Ethics And Course Info
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-15-ethics">
     Video 15: Ethics
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id23">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-16-be-a-group">
     Video 16: Be a group
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id24">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-17-syllabus">
     Video 17: Syllabus
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id25">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#meet-our-lecturers">
     Meet our lecturers
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#week-1-the-building-blocks">
       Week 1: the building blocks
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#week-2-making-things-work">
       Week 2: making things work
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#week-3-more-magic">
       Week 3: more magic
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#daily-survey">
   Daily survey
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-60-years-of-machine-learning-research-in-one-plot">
   Bonus - 60 years of Machine Learning Research in one Plot
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-altair-and-vega-datasets">
     Install and Import
     <code class="docutils literal notranslate">
      <span class="pre">
       altair
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       vega_datasets
      </span>
     </code>
     .
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-visualization-using-altair">
     Define Visualization using ALtair
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#questions">
     Questions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id26">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#methods">
     Methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-authors">
       Find Authors
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#edit-the-author-filter-variable-to-full-text-search-for-authors">
         Edit the
         <code class="docutils literal notranslate">
          <span class="pre">
           AUTHOR_FILTER
          </span>
         </code>
         variable to full text search for authors.
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix">
   Appendix
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#official-pytorch-resources">
     Official PyTorch resources:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tutorials">
       Tutorials
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#documentation">
       Documentation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#google-colab-resources">
     Google Colab Resources:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#books-for-reference">
     Books for reference:
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content-dl/blob/main/tutorials/W1D1_BasicsAndPytorch/student/W1D1_Tutorial1.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>  <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W1D1_BasicsAndPytorch/student/W1D1_Tutorial1.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a></p>
<div class="section" id="tutorial-1-pytorch">
<h1>Tutorial 1: PyTorch<a class="headerlink" href="#tutorial-1-pytorch" title="Permalink to this headline"></a></h1>
<p><strong>Week 1, Day 1: Basics and PyTorch</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Shubh Pachchigar, Vladimir Haltakov, Matthew Sargent, Konrad Kording</p>
<p><strong>Content reviewers:</strong> Deepak Raya, Siwei Bai, Kelson Shilling-Scrivo</p>
<p><strong>Content editors:</strong> Anoop Kulkarni, Spiros Chavlis</p>
<p><strong>Production editors:</strong> Arush Tagade, Spiros Chavlis</p>
</div>
<hr class="docutils" />
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline"></a></h1>
<p>Then have a few specific objectives for this tutorial:</p>
<ul class="simple">
<li><p>Learn about PyTorch and tensors</p></li>
<li><p>Tensor Manipulations</p></li>
<li><p>Data Loading</p></li>
<li><p>GPUs and CUDA Tensors</p></li>
<li><p>Train NaiveNet</p></li>
<li><p>Get to know your pod</p></li>
<li><p>Start thinking about the course as a whole</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "169bbf0c81214a40b86f4b4840665985"}
</script></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline"></a></h1>
<p>Throughout your Neuromatch tutorials, most (probably all!) notebooks contain setup cells. These cells will import the required Python packages (e.g., PyTorch, NumPy); set global or environment variables, and load in helper functions for things like plotting. In some tutorials, you will notice that we install some dependencies even if they are preinstalled on Google Colab or Kaggle. This happens because we have added automation to our repository through <a class="reference external" href="https://docs.github.com/en/actions/learn-github-actions/introduction-to-github-actions">GitHub Actions</a>.</p>
<p>Be sure to run all of the cells in the setup section. Feel free to expand them and have a look at what you are loading in, but you should be able to fulfill the learning objectives of every tutorial without having to look at these cells.</p>
<p>If you start building your own projects built on this code base we highly recommend looking at them in more detail.</p>
<div class="section" id="install-dependencies">
<h2>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install dependencies</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pandas<span class="w"> </span>--quiet
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="install-and-import-feedback-gadget">
<h2>Install and import feedback gadget<a class="headerlink" href="#install-and-import-feedback-gadget" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install and import feedback gadget</span>
<span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>vibecheck<span class="w"> </span>datatops<span class="w"> </span>--quiet

<span class="kn">from</span> <span class="nn">vibecheck</span> <span class="kn">import</span> <span class="n">DatatopsContentReviewContainer</span>
<span class="k">def</span> <span class="nf">content_review</span><span class="p">(</span><span class="n">notebook_section</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DatatopsContentReviewContainer</span><span class="p">(</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># No text prompt</span>
        <span class="n">notebook_section</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://pmyvdlilci.execute-api.us-east-1.amazonaws.com/klab&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;neuromatch_dl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;user_key&quot;</span><span class="p">:</span> <span class="s2">&quot;f379rz8y&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>


<span class="n">feedback_prefix</span> <span class="o">=</span> <span class="s2">&quot;W1D1_T1&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># PyTorch libraries</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;matplotlib.font_manager&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/NeuromatchAcademy/content-creation/main/nma.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper Functions</span>

<span class="k">def</span> <span class="nf">checkExercise1</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function for checking Exercise 1.</span>

<span class="sd">  Args:</span>
<span class="sd">    A: torch.Tensor</span>
<span class="sd">      Torch Tensor of shape (20, 21) consisting of ones.</span>
<span class="sd">    B: torch.Tensor</span>
<span class="sd">      Torch Tensor of size([3,4])</span>
<span class="sd">    C: torch.Tensor</span>
<span class="sd">      Torch Tensor of size([20,21])</span>
<span class="sd">    D: torch.Tensor</span>
<span class="sd">      Torch Tensor of size([19])</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="nb">int</span><span class="p">)),</span> <span class="s2">&quot;Got: </span><span class="si">{A}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> Expected: {torch.ones(20, 21)} (shape: {torch.ones(20, 21).shape})&quot;</span>
  <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">)),</span> <span class="s2">&quot;Got: </span><span class="si">{B}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> Expected: {np.vander([1, 2, 3], 4)} (shape: {np.vander([1, 2, 3], 4).shape})&quot;</span>
  <span class="k">assert</span> <span class="n">C</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="s2">&quot;Got: </span><span class="si">{C}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> Expected (shape: {(20, 21)})&quot;</span>
  <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span> <span class="s2">&quot;Got </span><span class="si">{D}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> Expected: {torch.arange(4, 41, step=2)} (shape: {torch.arange(4, 41, step=2).shape})&quot;</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All correct&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">timeFun</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function to calculate amount of time taken per instance on CPU/GPU</span>

<span class="sd">  Args:</span>
<span class="sd">    f: BufferedReader IO instance</span>
<span class="sd">      Function name for which to calculate computational time complexity</span>
<span class="sd">    dim: Integer</span>
<span class="sd">      Number of dimensions in instance in question</span>
<span class="sd">    iterations: Integer</span>
<span class="sd">      Number of iterations for instance in question</span>
<span class="sd">    device: String</span>
<span class="sd">      Device on which respective computation is to be run</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">iterations</span> <span class="o">=</span> <span class="n">iterations</span>
  <span class="n">t_total</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">f</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">t_total</span> <span class="o">+=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>

  <span class="k">if</span> <span class="n">device</span> <span class="o">==</span> <span class="s1">&#39;cpu&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;time taken for </span><span class="si">{</span><span class="n">iterations</span><span class="si">}</span><span class="s2"> iterations of </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">t_total</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;time taken for </span><span class="si">{</span><span class="n">iterations</span><span class="si">}</span><span class="s2"> iterations of </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">t_total</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Important note: Colab users</strong></p>
<p><em>Scratch Code Cells</em></p>
<p>If you want to quickly try out something or take a look at the data, you can use scratch code cells. They allow you to run Python code, but will not mess up the structure of your notebook.</p>
<p>To open a new scratch cell go to <em>Insert</em>  <em>Scratch code cell</em>.</p>
</div>
</div>
<div class="section" id="section-1-welcome-to-neuromatch-deep-learning-course">
<h1>Section 1: Welcome to Neuromatch Deep learning course<a class="headerlink" href="#section-1-welcome-to-neuromatch-deep-learning-course" title="Permalink to this headline"></a></h1>
<p><em>Time estimate: ~25mins</em></p>
<div class="section" id="video-1-welcome-and-history">
<h2>Video 1: Welcome and History<a class="headerlink" href="#video-1-welcome-and-history" title="Permalink to this headline"></a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "31cd44b1f1684ae49d71c5e1bfdb4777"}
</script></div>
</div>
<p>This will be an intensive 3 week adventure. We will all learn Deep Learning (DL) in a group. Groups need standards. Read our
<a class="reference external" href="https://docs.google.com/document/d/1eHKIkaNbAlbx_92tLQelXnicKXEcvFzlyzzeWjEtifM/edit?usp=sharing">Code of Conduct</a>.</p>
</div>
<div class="section" id="submit-your-feedback">
<h2>Submit your feedback<a class="headerlink" href="#submit-your-feedback" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Welcome_and_History_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c662479ed5d9421c90b44852c8027604"}
</script></div>
</div>
</div>
<div class="section" id="video-2-why-dl-is-cool">
<h2>Video 2: Why DL is cool<a class="headerlink" href="#video-2-why-dl-is-cool" title="Permalink to this headline"></a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "4c50a41bcede414b8b940cf3fbffcb70"}
</script></div>
</div>
<p><strong>Discuss with your pod: What do you hope to get out of this course? [in about 100 words]</strong></p>
</div>
<div class="section" id="id1">
<h2>Submit your feedback<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Why_DL_is_cool_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3d69b3d85e4b4f58b4e5b73ccb47fe03"}
</script></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-2-the-basics-of-pytorch">
<h1>Section 2: The Basics of PyTorch<a class="headerlink" href="#section-2-the-basics-of-pytorch" title="Permalink to this headline"></a></h1>
<p><em>Time estimate: ~2 hours 05 mins</em></p>
<p>PyTorch is a Python-based scientific computing package targeted at two sets of
audiences:</p>
<ul class="simple">
<li><p>A replacement for NumPy optimized for the power of GPUs</p></li>
<li><p>A deep learning platform that provides significant flexibility
and speed</p></li>
</ul>
<p>At its core, PyTorch provides a few key features:</p>
<ul class="simple">
<li><p>A multidimensional <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html">Tensor</a> object, similar to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html">NumPy Array</a> but with GPU acceleration.</p></li>
<li><p>An optimized <strong>autograd</strong> engine for automatically computing derivatives.</p></li>
<li><p>A clean, modular API for building and deploying <strong>deep learning models</strong>.</p></li>
</ul>
<p>You can find more information about PyTorch in the Appendix.</p>
<div class="section" id="section-2-1-creating-tensors">
<h2>Section 2.1: Creating Tensors<a class="headerlink" href="#section-2-1-creating-tensors" title="Permalink to this headline"></a></h2>
<div class="section" id="video-3-making-tensors">
<h3>Video 3: Making Tensors<a class="headerlink" href="#video-3-making-tensors" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "bd1a85fed6a040cb98cd6503cd547db4"}
</script></div>
</div>
</div>
<div class="section" id="id2">
<h3>Submit your feedback<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Making_Tensors_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "a8d47741cf1145d89d977972bdadf393"}
</script></div>
</div>
<p>There are various ways of creating tensors, and when doing any real deep learning project, we will usually have to do so.</p>
<p><strong>Construct tensors directly:</strong></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can construct a tensor directly from some common python iterables,</span>
<span class="c1"># such as list and tuple nested iterables can also be handled as long as the</span>
<span class="c1"># dimensions are compatible</span>

<span class="c1"># tensor from a list</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1">#tensor from a tuple of tuples</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># tensor from a numpy array</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor a: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor b: </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor c: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensor a: tensor([0, 1, 2])
Tensor b: tensor([[1.0000, 1.1000],
        [1.2000, 1.3000]])
Tensor c: tensor([[1., 1., 1.],
        [1., 1., 1.]], dtype=torch.float64)
</pre></div>
</div>
</div>
</div>
<p><strong>Some common tensor constructors:</strong></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The numerical arguments we pass to these constructors</span>
<span class="c1"># determine the shape of the output tensor</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor x: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor y: </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor z: </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensor x: tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
Tensor y: tensor([0., 0.])
Tensor z: tensor([[[0., 0., 0., 0., 0.]]])
</pre></div>
</div>
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">.empty()</span></code> does not return zeros, but seemingly random numbers. Unlike <code class="docutils literal notranslate"><span class="pre">.zeros()</span></code>, which initialises the elements of the tensor with zeros, <code class="docutils literal notranslate"><span class="pre">.empty()</span></code> just allocates the memory. It is hence a bit faster if you are looking to just create a tensor.</p>
<p><strong>Creating random tensors and tensors like other tensors:</strong></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># There are also constructors for random numbers</span>

<span class="c1"># Uniform distribution</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Normal distribution</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># There are also constructors that allow us to construct</span>
<span class="c1"># a tensor according to the above constructors, but with</span>
<span class="c1"># dimensions equal to another tensor.</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor a: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor b: </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor c: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor d: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensor a: tensor([[0.1006, 0.4721, 0.9332]])
Tensor b: tensor([[ 0.9300, -1.3968, -0.0203,  0.8492],
        [ 0.7901, -0.0428, -0.3996,  1.6280],
        [ 2.6036,  1.2625,  0.2054, -0.5992]])
Tensor c: tensor([[0., 0., 0.]])
Tensor d: tensor([[0.9996, 0.5628, 0.8158]])
</pre></div>
</div>
</div>
</div>
<p><em>Reproducibility</em>:</p>
<ul class="simple">
<li><p>PyTorch Random Number Generator (RNG): You can use <code class="docutils literal notranslate"><span class="pre">torch.manual_seed()</span></code> to seed the RNG for all devices (both CPU and GPU):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>For custom operators, you might need to set python seed as well:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Random number generators in other libraries (e.g., NumPy):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we define for you a function called <code class="docutils literal notranslate"><span class="pre">set_seed</span></code> that does the job for you!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed_torch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Function that controls randomness. NumPy and random modules must be imported.</span>

<span class="sd">  Args:</span>
<span class="sd">    seed : Integer</span>
<span class="sd">      A non-negative integer that defines the random state. Default is `None`.</span>
<span class="sd">    seed_torch : Boolean</span>
<span class="sd">      If `True` sets the random seed for pytorch tensors, so pytorch module</span>
<span class="sd">      must be imported. Default is `True`.</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">seed_torch</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Random seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1"> has been set.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, lets use the <code class="docutils literal notranslate"><span class="pre">set_seed</span></code> function in the previous example. Execute the cell multiple times to verify that the numbers printed are always the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simplefun</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">my_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function to verify effectiveness of set_seed attribute</span>

<span class="sd">  Args:</span>
<span class="sd">    seed: Boolean</span>
<span class="sd">      Specifies if seed value is provided or not</span>
<span class="sd">    my_seed: Integer</span>
<span class="sd">      Initializes seed to specified value</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">seed</span><span class="p">:</span>
    <span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">my_seed</span><span class="p">)</span>

  <span class="c1"># uniform distribution</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
  <span class="c1"># normal distribution</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tensor a: &quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tensor b: &quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simplefun</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">my_seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Turn `seed` to `False` or change `my_seed`</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 0 has been set.
Tensor a:  tensor([[0.4963, 0.7682, 0.0885]])
Tensor b:  tensor([[ 0.3643,  0.1344,  0.1642,  0.3058],
        [ 0.2100,  0.9056,  0.6035,  0.8110],
        [-0.0451,  0.8797,  1.0482, -0.0445]])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="numpy-like-number-ranges">
<h2><strong>Numpy-like number ranges:</strong><a class="headerlink" href="#numpy-like-number-ranges" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.arange()</span></code> and <code class="docutils literal notranslate"><span class="pre">.linspace()</span></code> behave how you would expect them to if you are familar with numpy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor a: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Numpy array b: </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor c: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Numpy array d: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensor a: tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])

Numpy array b: [0 1 2 3 4 5 6 7 8 9]

Tensor c: tensor([0.0000, 0.5000, 1.0000, 1.5000, 2.0000, 2.5000, 3.0000, 3.5000, 4.0000,
        4.5000, 5.0000])

Numpy array d: [0.  0.5 1.  1.5 2.  2.5 3.  3.5 4.  4.5 5. ]
</pre></div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-2-1-creating-tensors">
<h3>Coding Exercise 2.1: Creating Tensors<a class="headerlink" href="#coding-exercise-2-1-creating-tensors" title="Permalink to this headline"></a></h3>
<p>Below you will find some incomplete code. Fill in the missing code to construct the specified tensors.</p>
<p>We want the tensors:</p>
<p><span class="math notranslate nohighlight">\(A:\)</span> 20 by 21 tensor consisting of ones</p>
<p><span class="math notranslate nohighlight">\(B:\)</span> a tensor with elements equal to the elements of numpy array <span class="math notranslate nohighlight">\(Z\)</span></p>
<p><span class="math notranslate nohighlight">\(C:\)</span> a tensor with the same number of elements as <span class="math notranslate nohighlight">\(A\)</span> but with values <span class="math notranslate nohighlight">\(
\sim \mathcal{U}(0,1)^\dagger\)</span></p>
<p><span class="math notranslate nohighlight">\(D:\)</span> a 1D tensor containing the even numbers between 4 and 40 inclusive.</p>
<br>
<p><span class="math notranslate nohighlight">\(^\dagger\)</span>: <span class="math notranslate nohighlight">\(\mathcal{U(\alpha, \beta)}\)</span> denotes the <a class="reference external" href="https://en.wikipedia.org/wiki/Continuous_uniform_distribution">uniform distribution</a> from <span class="math notranslate nohighlight">\(\alpha\)</span> to <span class="math notranslate nohighlight">\(\beta\)</span>, with <span class="math notranslate nohighlight">\(\alpha, \beta \in \mathbb{R}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tensor_creation</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A function that creates various tensors.</span>

<span class="sd">  Args:</span>
<span class="sd">    Z: numpy.ndarray</span>
<span class="sd">      An array of shape (3,4)</span>

<span class="sd">  Returns:</span>
<span class="sd">    A : Tensor</span>
<span class="sd">      20 by 21 tensor consisting of ones</span>
<span class="sd">    B : Tensor</span>
<span class="sd">      A tensor with elements equal to the elements of numpy array Z</span>
<span class="sd">    C : Tensor</span>
<span class="sd">      A tensor with the same number of elements as A but with values U(0,1)</span>
<span class="sd">    D : Tensor</span>
<span class="sd">      A 1D tensor containing the even numbers between 4 and 40 inclusive.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">#################################################</span>
  <span class="c1">## TODO for students: fill in the missing code</span>
  <span class="c1">## from the first expression</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: say what they should have done&quot;</span><span class="p">)</span>
  <span class="c1">#################################################</span>
  <span class="n">A</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">B</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">C</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">D</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span>


<span class="c1"># numpy array to copy later</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vander</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Uncomment below to check your function!</span>
<span class="c1"># A, B, C, D = tensor_creation(Z)</span>
<span class="c1"># checkExercise1(A, B, C, D)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_7137e978.py"><em>Click for solution</em></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>All correct!
</pre></div>
</div>
<div class="section" id="id3">
<h4>Submit your feedback<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Creating_Tensors_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "06ea308ebd8b457bb0d9faee66012a9a"}
</script></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-2-2-operations-in-pytorch">
<h2>Section 2.2: Operations in PyTorch<a class="headerlink" href="#section-2-2-operations-in-pytorch" title="Permalink to this headline"></a></h2>
<p><strong>Tensor-Tensor operations</strong></p>
<p>We can perform operations on tensors using methods under <code class="docutils literal notranslate"><span class="pre">torch.</span></code></p>
<div class="section" id="video-4-tensor-operators">
<h3>Video 4: Tensor Operators<a class="headerlink" href="#video-4-tensor-operators" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9fc330cf63cb4b2eb8c82acb17ee7b67"}
</script></div>
</div>
</div>
<div class="section" id="id4">
<h3>Submit your feedback<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Tensors_Operators_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8e93adc603764e4f8e258390ab5186b4"}
</script></div>
</div>
<p><strong>Tensor-Tensor operations</strong></p>
<p>We can perform operations on tensors using methods under <code class="docutils literal notranslate"><span class="pre">torch.</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># this only works if c and d already exist</span>
<span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>

<span class="c1"># Pointwise Multiplication of a and b</span>
<span class="n">torch</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[1.0362, 1.1852, 1.3734],
        [1.3051, 1.9320, 1.1759],
        [1.2698, 1.1507, 1.0317],
        [1.2081, 1.9298, 1.7231],
        [1.7423, 1.5263, 1.2437]])
tensor([[0.0362, 0.1852, 0.3734],
        [0.3051, 0.9320, 0.1759],
        [0.2698, 0.1507, 0.0317],
        [0.2081, 0.9298, 0.7231],
        [0.7423, 0.5263, 0.2437]])
</pre></div>
</div>
</div>
</div>
<p>However, in PyTorch, most common Python operators are overridden.
The common standard arithmetic operators (<span class="math notranslate nohighlight">\(+\)</span>, <span class="math notranslate nohighlight">\(-\)</span>, <span class="math notranslate nohighlight">\(*\)</span>, <span class="math notranslate nohighlight">\(/\)</span>, and <span class="math notranslate nohighlight">\(**\)</span>) have all been lifted to elementwise operations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">y</span>  <span class="c1"># The `**` is the exponentiation operator</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([ 2,  4,  7, 12]),
 tensor([0, 0, 1, 4]),
 tensor([ 1,  4, 12, 32]),
 tensor([1.0000, 1.0000, 1.3333, 2.0000]),
 tensor([   1,    4,   64, 4096]))
</pre></div>
</div>
</div>
</div>
<p><strong>Tensor Methods</strong></p>
<p>Tensors also have a number of common arithmetic operations built in. A full list of <strong>all</strong> methods can be found  in the appendix (there are a lot!)</p>
<p>All of these operations should have similar syntax to their numpy equivalents (feel free to skip if you already know this!).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># sum() - note the axis is the axis you move across when summing</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of every element of x: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of the columns of x: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of the rows of x: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean value of all elements of x </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean values of the columns of x </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean values of the rows of x </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[0.5846, 0.0332, 0.1387],
        [0.2422, 0.8155, 0.7932],
        [0.2783, 0.4820, 0.8198]])


Sum of every element of x: 4.187318325042725
Sum of the columns of x: tensor([1.1051, 1.3306, 1.7517])
Sum of the rows of x: tensor([0.7565, 1.8509, 1.5800])


Mean value of all elements of x 0.46525758504867554
Mean values of the columns of x tensor([0.3684, 0.4435, 0.5839])
Mean values of the rows of x tensor([0.2522, 0.6170, 0.5267])
</pre></div>
</div>
</div>
</div>
<p><strong>Matrix Operations</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol is overridden to represent matrix multiplication. You can also use <code class="docutils literal notranslate"><span class="pre">torch.matmul()</span></code> to multiply tensors. For dot multiplication, you can use <code class="docutils literal notranslate"><span class="pre">torch.dot()</span></code>, or manipulate the axes of your tensors and do matrix multiplication (we will cover that in the next section).</p>
<p>Transposes of 2D tensors are obtained using <code class="docutils literal notranslate"><span class="pre">torch.t()</span></code> or <code class="docutils literal notranslate"><span class="pre">Tensor.T</span></code>. Note the lack of brackets for <code class="docutils literal notranslate"><span class="pre">Tensor.T</span></code> - it is an attribute, not a method.</p>
</div>
<div class="section" id="coding-exercise-2-2-simple-tensor-operations">
<h3>Coding Exercise 2.2 : Simple tensor operations<a class="headerlink" href="#coding-exercise-2-2-simple-tensor-operations" title="Permalink to this headline"></a></h3>
<p>Below are two expressions involving operations on matrices.</p>
<div class="amsmath math notranslate nohighlight" id="equation-569cacab-393e-4a1c-bbfe-caca875a4a84">
<span class="eqno">(1)<a class="headerlink" href="#equation-569cacab-393e-4a1c-bbfe-caca875a4a84" title="Permalink to this equation"></a></span>\[\begin{equation}
\textbf{A} =
\begin{bmatrix}2 &amp;4 \\5 &amp; 7
\end{bmatrix}
\begin{bmatrix} 1 &amp;1 \\2 &amp; 3
\end{bmatrix}
+
\begin{bmatrix}10 &amp; 10  \\ 12 &amp; 1
\end{bmatrix}
\end{equation}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight" id="equation-5029fd7b-2e4d-41a8-8f2c-abd790ddc78e">
<span class="eqno">(2)<a class="headerlink" href="#equation-5029fd7b-2e4d-41a8-8f2c-abd790ddc78e" title="Permalink to this equation"></a></span>\[\begin{equation}
b =
\begin{bmatrix} 3 \\ 5 \\ 7
\end{bmatrix} \cdot
\begin{bmatrix} 2 \\ 4 \\ 8
\end{bmatrix}
\end{equation}\]</div>
<p>The code block below that computes these expressions using PyTorch is incomplete - fill in the missing lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simple_operations</span><span class="p">(</span><span class="n">a1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">a2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">a3</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function to demonstrate simple operations</span>
<span class="sd">  i.e., Multiplication of tensor a1 with tensor a2 and then add it with tensor a3</span>

<span class="sd">  Args:</span>
<span class="sd">    a1: Torch tensor</span>
<span class="sd">      Tensor of size ([2,2])</span>
<span class="sd">    a2: Torch tensor</span>
<span class="sd">      Tensor of size ([2,2])</span>
<span class="sd">    a3: Torch tensor</span>
<span class="sd">      Tensor of size ([2,2])</span>

<span class="sd">  Returns:</span>
<span class="sd">    answer: Torch tensor</span>
<span class="sd">      Tensor of size ([2,2]) resulting from a1 multiplied with a2, added with a3</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">################################################</span>
  <span class="c1">## TODO for students:  complete the first computation using the argument matricies</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: fill in the missing code to complete the operation&quot;</span><span class="p">)</span>
  <span class="c1">################################################</span>
  <span class="c1">#</span>
  <span class="n">answer</span> <span class="o">=</span> <span class="o">...</span>
  <span class="k">return</span> <span class="n">answer</span>


<span class="c1"># Computing expression 1:</span>

<span class="c1"># init our tensors</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">a3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="c1">## uncomment to test your function</span>
<span class="c1"># A = simple_operations(a1, a2, a3)</span>
<span class="c1"># print(A)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_10c96625.py"><em>Click for solution</em></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">27</span><span class="p">]])</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dot_product</span><span class="p">(</span><span class="n">b1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">b2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
  <span class="c1">###############################################</span>
  <span class="c1">## TODO for students:  complete the first computation using the argument matricies</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: fill in the missing code to complete the operation&quot;</span><span class="p">)</span>
  <span class="c1">###############################################</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function to demonstrate dot product operation</span>
<span class="sd">  Dot product is an algebraic operation that takes two equal-length sequences</span>
<span class="sd">  (usually coordinate vectors), and returns a single number.</span>
<span class="sd">  Geometrically, it is the product of the Euclidean magnitudes of the</span>
<span class="sd">  two vectors and the cosine of the angle between them.</span>

<span class="sd">  Args:</span>
<span class="sd">    b1: Torch tensor</span>
<span class="sd">      Tensor of size ([3])</span>
<span class="sd">    b2: Torch tensor</span>
<span class="sd">      Tensor of size ([3])</span>

<span class="sd">  Returns:</span>
<span class="sd">    product: Tensor</span>
<span class="sd">      Tensor of size ([1]) resulting from b1 scalar multiplied with b2</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1"># Use torch.dot() to compute the dot product of two tensors</span>
  <span class="n">product</span> <span class="o">=</span> <span class="o">...</span>
  <span class="k">return</span> <span class="n">product</span>


<span class="c1"># Computing expression 2:</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="c1">## Uncomment to test your function</span>
<span class="c1"># b = dot_product(b1, b2)</span>
<span class="c1"># print(b)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_84663577.py"><em>Click for solution</em></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">(</span><span class="mi">82</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id5">
<h4>Submit your feedback<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Simple_Tensor_Operations_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "486591721ab24dadad199d8edd02a709"}
</script></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-2-3-manipulating-tensors-in-pytorch">
<h2>Section 2.3 Manipulating Tensors in Pytorch<a class="headerlink" href="#section-2-3-manipulating-tensors-in-pytorch" title="Permalink to this headline"></a></h2>
<div class="section" id="video-5-tensor-indexing">
<h3>Video 5: Tensor Indexing<a class="headerlink" href="#video-5-tensor-indexing" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "a20580f760c5477393e8372ac3503b61"}
</script></div>
</div>
</div>
<div class="section" id="id6">
<h3>Submit your feedback<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Manipulating_Tensors_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "6f8426f525454fdbbc6288059ec12690"}
</script></div>
</div>
<p><strong>Indexing</strong></p>
<p>Just as in numpy, elements in a tensor can be accessed by index. As in any numpy array, the first element has index 0 and ranges are specified to include the first to last_element-1. We can access elements according to their relative position to the end of the list by using negative indices. Indexing is also referred to as slicing.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">[-1]</span></code> selects the last element; <code class="docutils literal notranslate"><span class="pre">[1:3]</span></code> selects the second and the third elements, and <code class="docutils literal notranslate"><span class="pre">[:-2]</span></code> will select all elements excluding the last and second-to-last elements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
tensor(9)
tensor([1, 2])
tensor([0, 1, 2, 3, 4, 5, 6, 7])
</pre></div>
</div>
</div>
</div>
<p>When we have multidimensional tensors, indexing rules work the same way as NumPy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a 5D tensor</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; shape of x[0]:</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; shape of x[0][0]:</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; shape of x[0][0][0]:</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> shape of x[0]:torch.Size([2, 3, 4, 5])
 shape of x[0][0]:torch.Size([3, 4, 5])
 shape of x[0][0][0]:torch.Size([4, 5])
</pre></div>
</div>
</div>
</div>
<p><strong>Flatten and reshape</strong></p>
<p>There are various methods for reshaping tensors. It is common to have to express 2D data in 1D format. Similarly, it is also common to have to reshape a 1D tensor into a 2D tensor. We can achieve this with the <code class="docutils literal notranslate"><span class="pre">.flatten()</span></code> and <code class="docutils literal notranslate"><span class="pre">.reshape()</span></code> methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original z: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 2D -&gt; 1D</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flattened z: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># and back to 2D</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reshaped (3x4) z: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original z: 
 tensor([[ 0,  1],
        [ 2,  3],
        [ 4,  5],
        [ 6,  7],
        [ 8,  9],
        [10, 11]])
Flattened z: 
 tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])
Reshaped (3x4) z: 
 tensor([[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]])
</pre></div>
</div>
</div>
</div>
<p>You will also see the <code class="docutils literal notranslate"><span class="pre">.view()</span></code> methods used a lot to reshape tensors. There is a subtle difference between <code class="docutils literal notranslate"><span class="pre">.view()</span></code> and <code class="docutils literal notranslate"><span class="pre">.reshape()</span></code>, though for now we will just use <code class="docutils literal notranslate"><span class="pre">.reshape()</span></code>. The documentation can be found in the Appendix.</p>
<p><strong>Squeezing tensors</strong></p>
<p>When processing batches of data, you will quite often be left with singleton dimensions. E.g., <code class="docutils literal notranslate"><span class="pre">[1,10]</span></code> or <code class="docutils literal notranslate"><span class="pre">[256,</span> <span class="pre">1,</span> <span class="pre">3]</span></code>. This dimension can quite easily mess up your matrix operations if you dont plan on it being there</p>
<p>In order to compress tensors along their singleton dimensions we can use the <code class="docutils literal notranslate"><span class="pre">.squeeze()</span></code> method. We can use the <code class="docutils literal notranslate"><span class="pre">.unsqueeze()</span></code> method to do the opposite.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># printing the zeroth element of the tensor will not give us the first number!</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x[0]: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([1, 10])
x[0]: tensor([-0.7391,  0.8027, -0.6817, -0.1335,  0.0658, -0.5919,  0.7670,  0.6899,
         0.3282,  0.5085])
</pre></div>
</div>
</div>
</div>
<p>Because of that pesky singleton dimension, <code class="docutils literal notranslate"><span class="pre">x[0]</span></code> gave us the first row instead!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s get rid of that singleton dimension and see what happens now</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x[0]: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([10])
x[0]: -0.7390837073326111
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding singleton dimensions works a similar way, and is often used when tensors</span>
<span class="c1"># being added need same number of dimensions</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of y: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># lets insert a singleton dimension</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of y: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of y: torch.Size([5, 5])
Shape of y: torch.Size([5, 1, 5])
</pre></div>
</div>
</div>
</div>
<p><strong>Permutation</strong></p>
<p>Sometimes our dimensions will be in the wrong order! For example, we may be dealing with RGB images with dim <span class="math notranslate nohighlight">\([3\times48\times64]\)</span>, but our pipeline expects the colour dimension to be the last dimension, i.e., <span class="math notranslate nohighlight">\([48\times64\times3]\)</span>. To get around this we can use the <code class="docutils literal notranslate"><span class="pre">.permute()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># `x` has dimensions [color,image_height,image_width]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

<span class="c1"># We want to permute our tensor to be [ image_height , image_width , color ]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># permute(1,2,0) means:</span>
<span class="c1"># The 0th dim of my new tensor = the 1st dim of my old tensor</span>
<span class="c1"># The 1st dim of my new tensor = the 2nd</span>
<span class="c1"># The 2nd dim of my new tensor = the 0th</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([48, 64, 3])
</pre></div>
</div>
</div>
</div>
<p>You may also see <code class="docutils literal notranslate"><span class="pre">.transpose()</span></code> used. This works in a similar way as permute, but can only swap two dimensions at once.</p>
<p><strong>Concatenation</strong></p>
<p>In this example, we concatenate two matrices along rows (axis 0, the first element of the shape) vs. columns (axis 1, the second element of the shape). We can see that the first output tensors axis-0 length (<code class="docutils literal notranslate"><span class="pre">6</span></code>) is the sum of the two input tensors axis-0 lengths (<code class="docutils literal notranslate"><span class="pre">3+3</span></code>); while the second output tensors axis-1 length (<code class="docutils literal notranslate"><span class="pre">8</span></code>) is the sum of the two input tensors axis-1 lengths (<code class="docutils literal notranslate"><span class="pre">4+4</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create two tensors of the same shape</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="c1"># Concatenate along rows</span>
<span class="n">cat_rows</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Concatenate along columns</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Printing outputs</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Concatenated by rows: shape</span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cat_rows</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">cat_rows</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Concatenated by colums: shape</span><span class="si">{}</span><span class="s1">  </span><span class="se">\n</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cat_cols</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">cat_cols</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Concatenated by rows: shape[6, 4] 
 tensor([[ 0.,  1.,  2.,  3.],
        [ 4.,  5.,  6.,  7.],
        [ 8.,  9., 10., 11.],
        [ 2.,  1.,  4.,  3.],
        [ 1.,  2.,  3.,  4.],
        [ 4.,  3.,  2.,  1.]])

 Concatenated by colums: shape[3, 8]  
 tensor([[ 0.,  1.,  2.,  3.,  2.,  1.,  4.,  3.],
        [ 4.,  5.,  6.,  7.,  1.,  2.,  3.,  4.],
        [ 8.,  9., 10., 11.,  4.,  3.,  2.,  1.]])
</pre></div>
</div>
</div>
</div>
<p><strong>Conversion to Other Python Objects</strong></p>
<p>Converting a tensor to a numpy.ndarray, or vice versa, is easy, and the converted result does not share memory. This minor inconvenience is quite important: when you perform operations on the CPU or GPUs, you do not want to halt computation, waiting to see whether the NumPy package of Python might want to be doing something else with the same chunk of memory.</p>
<p>When converting to a NumPy array, the information being tracked by the tensor will be lost, i.e., the computational graph. This will be covered in detail when you are introduced to autograd tomorrow!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">  |  x type:  </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y: </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">  |  y type:  </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z: </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">  |  z type:  </span><span class="si">{</span><span class="n">z</span><span class="o">.</span><span class="n">type</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x: tensor([ 0.2659, -0.5148, -0.0613,  0.5046,  0.1385])  |  x type:  torch.FloatTensor
y: [ 0.26593232 -0.5148316  -0.06128114  0.5046449   0.13848118]  |  y type:  &lt;class &#39;numpy.ndarray&#39;&gt;
z: tensor([ 0.2659, -0.5148, -0.0613,  0.5046,  0.1385])  |  z type:  torch.FloatTensor
</pre></div>
</div>
</div>
</div>
<p>To convert a size-1 tensor to a Python scalar, we can invoke the item function or Pythons built-in functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.5</span><span class="p">])</span>
<span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([3.5000]), 3.5, 3.5, 3)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-2-3-manipulating-tensors">
<h3>Coding Exercise 2.3: Manipulating Tensors<a class="headerlink" href="#coding-exercise-2-3-manipulating-tensors" title="Permalink to this headline"></a></h3>
<p>Using a combination of the methods discussed above, complete the functions below.</p>
<p><strong>Function A</strong></p>
<p>This function takes in two 2D tensors <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> and returns the column sum of A multiplied by the sum of all the elmements of <span class="math notranslate nohighlight">\(B\)</span>, i.e., a scalar, e.g.,</p>
<div class="amsmath math notranslate nohighlight" id="equation-ed296f68-5b89-462a-9ab2-6b86129f9ea3">
<span class="eqno">(3)<a class="headerlink" href="#equation-ed296f68-5b89-462a-9ab2-6b86129f9ea3" title="Permalink to this equation"></a></span>\[\begin{equation}
  \text{If }
  A = \begin{bmatrix}
  1 &amp; 1 \\
  1 &amp; 1
  \end{bmatrix}
  \text{and }
  B = \begin{bmatrix}
  1 &amp; 2 &amp; 3 \\
  1 &amp; 2 &amp; 3
  \end{bmatrix}
  \text{ then }
  Out =  \begin{bmatrix}
  2 &amp; 2
  \end{bmatrix} \cdot 12 = \begin{bmatrix}
  24 &amp; 24
  \end{bmatrix}
\end{equation}\]</div>
<p><strong>Function B</strong></p>
<p>This function takes in a square matrix <span class="math notranslate nohighlight">\(C\)</span> and returns a 2D tensor consisting of a flattened <span class="math notranslate nohighlight">\(C\)</span> with the index of each element appended to this tensor in the row dimension, e.g.,</p>
<div class="amsmath math notranslate nohighlight" id="equation-1e5f6b71-97eb-4b85-afe8-58331d91387f">
<span class="eqno">(4)<a class="headerlink" href="#equation-1e5f6b71-97eb-4b85-afe8-58331d91387f" title="Permalink to this equation"></a></span>\[\begin{equation}
  \text{If }
  C = \begin{bmatrix}
  2 &amp; 3 \\
  -1 &amp; 10
  \end{bmatrix}
  \text{ then }
  Out = \begin{bmatrix}
  0 &amp; 2 \\
  1 &amp; 3 \\
  2 &amp; -1 \\
  3 &amp; 10
  \end{bmatrix}
\end{equation}\]</div>
<p><strong>Hint:</strong> Pay close attention to singleton dimensions.</p>
<p><strong>Function C</strong></p>
<p>This function takes in two 2D tensors <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(E\)</span>. If the dimensions allow it, this function returns the elementwise sum of <span class="math notranslate nohighlight">\(D\)</span>-shaped <span class="math notranslate nohighlight">\(E\)</span>, and <span class="math notranslate nohighlight">\(D\)</span>; else this function returns a 1D tensor that is the concatenation of the two tensors, e.g.,</p>
<div class="amsmath math notranslate nohighlight" id="equation-2a973a3b-0033-45a1-ac93-5c5ca960b1f6">
<span class="eqno">(5)<a class="headerlink" href="#equation-2a973a3b-0033-45a1-ac93-5c5ca960b1f6" title="Permalink to this equation"></a></span>\[\begin{equation}
  \text{If }
  D = \begin{bmatrix}
  1 &amp; -1 \\
  -1 &amp; 3
  \end{bmatrix}
  \text{and }
  E = \begin{bmatrix}
  2 &amp; 3 &amp; 0 &amp; 2 \\
  \end{bmatrix}
  \text{ then }
  Out = \begin{bmatrix}
  3 &amp; 2 \\
  -1 &amp; 5
  \end{bmatrix}
\end{equation}\]</div>
<br>
<div class="amsmath math notranslate nohighlight" id="equation-b95fefe6-7e98-4839-a69d-a5b3a934d46e">
<span class="eqno">(6)<a class="headerlink" href="#equation-b95fefe6-7e98-4839-a69d-a5b3a934d46e" title="Permalink to this equation"></a></span>\[\begin{equation}
  \text{If }
  D = \begin{bmatrix}
  1 &amp; -1 \\
  -1 &amp; 3
  \end{bmatrix}
  \text{and }
  E = \begin{bmatrix}
  2 &amp; 3 &amp; 0  \\
  \end{bmatrix}
  \text{ then }
  Out = \begin{bmatrix}
  1 &amp; -1 &amp; -1 &amp; 3  &amp; 2 &amp; 3 &amp; 0
  \end{bmatrix}
\end{equation}\]</div>
<br>
<p><strong>Hint:</strong> <code class="docutils literal notranslate"><span class="pre">torch.numel()</span></code> is an easy way of finding the number of elements in a tensor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">functionA</span><span class="p">(</span><span class="n">my_tensor1</span><span class="p">,</span> <span class="n">my_tensor2</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This function takes in two 2D tensors `my_tensor1` and `my_tensor2`</span>
<span class="sd">  and returns the column sum of</span>
<span class="sd">  `my_tensor1` multiplied by the sum of all the elmements of `my_tensor2`,</span>
<span class="sd">  i.e., a scalar.</span>

<span class="sd">  Args:</span>
<span class="sd">    my_tensor1: torch.Tensor</span>
<span class="sd">    my_tensor2: torch.Tensor</span>

<span class="sd">  Retuns:</span>
<span class="sd">    output: torch.Tensor</span>
<span class="sd">      The multiplication of the column sum of `my_tensor1` by the sum of</span>
<span class="sd">      `my_tensor2`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">################################################</span>
  <span class="c1">## TODO for students: complete functionA</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: complete function A&quot;</span><span class="p">)</span>
  <span class="c1">################################################</span>
  <span class="c1"># TODO multiplication the sum of the tensors</span>
  <span class="n">output</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">output</span>


<span class="k">def</span> <span class="nf">functionB</span><span class="p">(</span><span class="n">my_tensor</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This function takes in a square matrix `my_tensor` and returns a 2D tensor</span>
<span class="sd">  consisting of a flattened `my_tensor` with the index of each element</span>
<span class="sd">  appended to this tensor in the row dimension.</span>

<span class="sd">  Args:</span>
<span class="sd">    my_tensor: torch.Tensor</span>

<span class="sd">  Returns:</span>
<span class="sd">    output: torch.Tensor</span>
<span class="sd">      Concatenated tensor.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">################################################</span>
  <span class="c1">## TODO for students: complete functionB</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: complete function B&quot;</span><span class="p">)</span>
  <span class="c1">################################################</span>
  <span class="c1"># TODO flatten the tensor `my_tensor`</span>
  <span class="n">my_tensor</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># TODO create the idx tensor to be concatenated to `my_tensor`</span>
  <span class="n">idx_tensor</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># TODO concatenate the two tensors</span>
  <span class="n">output</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">output</span>


<span class="k">def</span> <span class="nf">functionC</span><span class="p">(</span><span class="n">my_tensor1</span><span class="p">,</span> <span class="n">my_tensor2</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This function takes in two 2D tensors `my_tensor1` and `my_tensor2`.</span>
<span class="sd">  If the dimensions allow it, it returns the</span>
<span class="sd">  elementwise sum of `my_tensor1`-shaped `my_tensor2`, and `my_tensor2`;</span>
<span class="sd">  else this function returns a 1D tensor that is the concatenation of the</span>
<span class="sd">  two tensors.</span>

<span class="sd">  Args:</span>
<span class="sd">    my_tensor1: torch.Tensor</span>
<span class="sd">    my_tensor2: torch.Tensor</span>

<span class="sd">  Returns:</span>
<span class="sd">    output: torch.Tensor</span>
<span class="sd">      Concatenated tensor.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">################################################</span>
  <span class="c1">## TODO for students: complete functionB</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: complete function C&quot;</span><span class="p">)</span>
  <span class="c1">################################################</span>
  <span class="c1"># TODO check we can reshape `my_tensor2` into the shape of `my_tensor1`</span>
  <span class="k">if</span> <span class="o">...</span><span class="p">:</span>
    <span class="c1"># TODO reshape `my_tensor2` into the shape of `my_tensor1`</span>
    <span class="n">my_tensor2</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># TODO sum the two tensors</span>
    <span class="n">output</span> <span class="o">=</span> <span class="o">...</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="c1"># TODO flatten both tensors</span>
    <span class="n">my_tensor1</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">my_tensor2</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># TODO concatenate the two tensors in the correct dimension</span>
    <span class="n">output</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">output</span>


<span class="c1">## Implement the functions above and then uncomment the following lines to test your code</span>
<span class="c1"># print(functionA(torch.tensor([[1, 1], [1, 1]]), torch.tensor([[1, 2, 3], [1, 2, 3]])))</span>
<span class="c1"># print(functionB(torch.tensor([[2, 3], [-1, 10]])))</span>
<span class="c1"># print(functionC(torch.tensor([[1, -1], [-1, 3]]), torch.tensor([[2, 3, 0, 2]])))</span>
<span class="c1"># print(functionC(torch.tensor([[1, -1], [-1, 3]]), torch.tensor([[2, 3, 0]])))</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_234c6f74.py"><em>Click for solution</em></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">])</span>
<span class="n">tensor</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="n">tensor</span><span class="p">([[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">5</span><span class="p">]])</span>
<span class="n">tensor</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="id7">
<h4>Submit your feedback<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Manipulating_Tensors_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "539b4896be6c401295e410e27ab3aec1"}
</script></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-2-4-gpus">
<h2>Section 2.4: GPUs<a class="headerlink" href="#section-2-4-gpus" title="Permalink to this headline"></a></h2>
<div class="section" id="video-6-gpu-vs-cpu">
<h3>Video 6: GPU vs CPU<a class="headerlink" href="#video-6-gpu-vs-cpu" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "ef3d35a659a54e97afc0e3aba0e846ea"}
</script></div>
</div>
</div>
<div class="section" id="id8">
<h3>Submit your feedback<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_GPU_vs_CPU_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "5e937f9a96894a40b51e5cc22cf48667"}
</script></div>
</div>
<p>By default, when we create a tensor it will <em>not</em> live on the GPU!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cpu
</pre></div>
</div>
</div>
</div>
<p>When using Colab notebooks, by default, will not have access to a GPU. In order to start using GPUs we need to request one. We can do this by going to the runtime tab at the top of the page.</p>
<p>By following <em>Runtime</em>  <em>Change runtime type</em> and selecting <strong>GPU</strong> from the <em>Hardware Accelerator</em> dropdown list, we can start playing with sending tensors to GPUs.</p>
<p>Once you have done this your runtime will restart and you will need to rerun the first setup cell to reimport PyTorch. Then proceed to the next cell.</p>
<p>For more information on the GPU usage policy you can view in the Appendix.</p>
<p><strong>Now we have a GPU.</strong></p>
<p>The cell below should return <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://developer.nvidia.com/cuda-toolkit">CUDA</a> is an API developed by Nvidia for interfacing with GPUs. PyTorch provides us with a layer of abstraction, and allows us to launch CUDA kernels using pure Python.</p>
<p>In short, we get the power of parallelizing our tensor computations on GPUs, whilst only writing (relatively) simple Python!</p>
<p>Here, we define the function <code class="docutils literal notranslate"><span class="pre">set_device</span></code>, which returns the device use in the notebook, i.e., <code class="docutils literal notranslate"><span class="pre">cpu</span></code> or <code class="docutils literal notranslate"><span class="pre">cuda</span></code>. Unless otherwise specified, we use this function on top of every tutorial, and we store the device variable such as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>
</pre></div>
</div>
<p>Lets define the function using the PyTorch package <code class="docutils literal notranslate"><span class="pre">torch.cuda</span></code>, which is lazily initialized, so we can always import it, and use <code class="docutils literal notranslate"><span class="pre">is_available()</span></code> to determine if our system supports CUDA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_device</span><span class="p">():</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Set the device. CUDA if available, CPU otherwise</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>
  <span class="k">if</span> <span class="n">device</span> <span class="o">!=</span> <span class="s2">&quot;cuda&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GPU is not enabled in this notebook. </span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="s2">&quot;If you want to enable it, in the menu under `Runtime` -&gt; </span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="s2">&quot;`Hardware accelerator.` and select `GPU` from the dropdown menu&quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GPU is enabled in this notebook. </span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="s2">&quot;If you want to disable it, in the menu under `Runtime` -&gt; </span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="s2">&quot;`Hardware accelerator.` and select `None` from the dropdown menu&quot;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">device</span>
</pre></div>
</div>
</div>
</div>
<p>Lets make some CUDA tensors!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># common device agnostic way of writing code that can run on cpu OR gpu</span>
<span class="c1"># that we provide for you in each of the tutorials</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>

<span class="c1"># we can specify a device when we first create our tensor</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="c1"># we can also use the .to() method to change the device a tensor lives on</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y before calling to() | device: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2"> | dtype: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">type</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y after calling to() | device: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2"> | dtype: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">type</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU is not enabled in this notebook. 
If you want to enable it, in the menu under `Runtime` -&gt; 
`Hardware accelerator.` and select `GPU` from the dropdown menu
torch.float32
cpu
y before calling to() | device: cpu | dtype: torch.FloatTensor
y after calling to() | device: cpu | dtype: torch.FloatTensor
</pre></div>
</div>
</div>
</div>
<p><strong>Operations between cpu tensors and cuda tensors</strong></p>
<p>Note that the type of the tensor changed after calling <code class="docutils literal notranslate"><span class="pre">.to()</span></code>. What happens if we try and perform operations on tensors on devices?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="c1">## Uncomment the following line and run this cell</span>
<span class="c1"># z = x + y</span>
</pre></div>
</div>
</div>
</div>
<p>We cannot combine CUDA tensors and CPU tensors in this fashion. If we want to compute an operation that combines tensors on different devices, we need to move them first! We can use the <code class="docutils literal notranslate"><span class="pre">.to()</span></code> method as before, or the <code class="docutils literal notranslate"><span class="pre">.cpu()</span></code> and <code class="docutils literal notranslate"><span class="pre">.cuda()</span></code> methods. Note that using the <code class="docutils literal notranslate"><span class="pre">.cuda()</span></code> will throw an error, if CUDA is not enabled in your machine.</p>
<p>Generally, in this course, all Deep Learning is done on the GPU, and any computation is done on the CPU, so sometimes we have to pass things back and forth, so youll see us call.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="c1"># moving to cpu</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>  <span class="c1"># alternatively, you can use x = x.cpu()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># moving to gpu</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>  <span class="c1"># alternatively, you can use y = y.cuda()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([3, 5, 7])
tensor([ 9, 11, 13])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-2-4-just-how-much-faster-are-gpus">
<h3>Coding Exercise 2.4: Just how much faster are GPUs?<a class="headerlink" href="#coding-exercise-2-4-just-how-much-faster-are-gpus" title="Permalink to this headline"></a></h3>
<p>Below is a simple function <code class="docutils literal notranslate"><span class="pre">simpleFun</span></code>. Complete this function, such that it performs the operations:</p>
<ul class="simple">
<li><p>Elementwise multiplication</p></li>
<li><p>Matrix multiplication</p></li>
</ul>
<p>The operations should be able to perfomed on either the CPU or GPU specified by the parameter <code class="docutils literal notranslate"><span class="pre">device</span></code>. We will use the helper function <code class="docutils literal notranslate"><span class="pre">timeFun(f,</span> <span class="pre">dim,</span> <span class="pre">iterations,</span> <span class="pre">device)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">iterations</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simpleFun</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function to check device-compatiblity with computations</span>

<span class="sd">  Args:</span>
<span class="sd">    dim: Integer</span>
<span class="sd">    device: String</span>
<span class="sd">      &quot;cpu&quot; or &quot;cuda&quot;</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">###############################################</span>
  <span class="c1">## TODO for students: recreate the function, but</span>
  <span class="c1">## ensure all computations happens on the `device`</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: fill in the missing code to create the tensors&quot;</span><span class="p">)</span>
  <span class="c1">###############################################</span>
  <span class="c1"># 2D tensor filled with uniform random numbers in [0,1), dim x dim</span>
  <span class="n">x</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># 2D tensor filled with uniform random numbers in [0,1), dim x dim</span>
  <span class="n">y</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># 2D tensor filled with the scalar value 2, dim x dim</span>
  <span class="n">z</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># elementwise multiplication of x and y</span>
  <span class="n">a</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># matrix multiplication of x and z</span>
  <span class="n">b</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">del</span> <span class="n">x</span>
  <span class="k">del</span> <span class="n">y</span>
  <span class="k">del</span> <span class="n">z</span>
  <span class="k">del</span> <span class="n">a</span>
  <span class="k">del</span> <span class="n">b</span>


<span class="c1">## Implement the function above and uncomment the following lines to test your code</span>
<span class="c1"># timeFun(f=simpleFun, dim=dim, iterations=iterations)</span>
<span class="c1"># timeFun(f=simpleFun, dim=dim, iterations=iterations, device=DEVICE)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_bb83a0e6.py"><em>Click for solution</em></a></p>
<p>Sample output (depends on your hardware)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="n">taken</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">iterations</span> <span class="n">of</span> <span class="n">simpleFun</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="n">cpu</span><span class="p">):</span> <span class="mf">23.74070</span>
<span class="n">time</span> <span class="n">taken</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">iterations</span> <span class="n">of</span> <span class="n">simpleFun</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="n">cuda</span><span class="p">):</span> <span class="mf">0.87535</span>
</pre></div>
</div>
<div class="section" id="id9">
<h4>Submit your feedback<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_How_Much_Faster_Are_GPUs_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3392ff3d6c974f3ba8a8d1342948ce23"}
</script></div>
</div>
<p><strong>Discuss!</strong></p>
<p>Try and reduce the dimensions of the tensors and increase the iterations. You can get to a point where the cpu only function is faster than the GPU function. Why might this be?</p>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_4ee0dee3.py"><em>Click for solution</em></a></p>
</div>
<div class="section" id="id10">
<h4>Submit your feedback<a class="headerlink" href="#id10" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_GPUs_Discussion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "cec74cf9a1c94fd1a9acae1d879d5bd5"}
</script></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-2-5-datasets-and-dataloaders">
<h2>Section 2.5: Datasets and Dataloaders<a class="headerlink" href="#section-2-5-datasets-and-dataloaders" title="Permalink to this headline"></a></h2>
<div class="section" id="video-7-getting-data">
<h3>Video 7: Getting Data<a class="headerlink" href="#video-7-getting-data" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b8b2c8eef96041e78f0ad594709ccb30"}
</script></div>
</div>
</div>
<div class="section" id="id11">
<h3>Submit your feedback<a class="headerlink" href="#id11" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Getting_Data_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "5486e69b80f542c8b0be9e2a4ca21f6c"}
</script></div>
</div>
<p>When training neural network models you will be working with large amounts of data. Fortunately, PyTorch offers some great tools that help you organize and manipulate your data samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import dataset and dataloaders related packages</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">Compose</span><span class="p">,</span> <span class="n">Grayscale</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Datasets</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">torchvision</span></code> package gives you easy access to many of the publicly available datasets. Lets load the <a class="reference external" href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR10</a> dataset, which contains color images of 10 different classes, like vehicles and animals.</p>
<p>Creating an object of type <code class="docutils literal notranslate"><span class="pre">datasets.CIFAR10</span></code> will automatically download and load all images from the dataset. The resulting data structure can be treated as a list containing data samples and their corresponding labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and load the images from the CIFAR10 dataset</span>
<span class="n">cifar10_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>  <span class="c1"># path where the images will be stored</span>
    <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># all images should be downloaded</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>  <span class="c1"># transform the images to tensors</span>
    <span class="p">)</span>

<span class="c1"># Print the number of samples in the loaded dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of samples: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cifar10_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class names: </span><span class="si">{</span><span class="n">cifar10_data</span><span class="o">.</span><span class="n">classes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to data/cifar-10-python.tar.gz
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">59</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Download and load the images from the CIFAR10 dataset</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">cifar10_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>  <span class="c1"># path where the images will be stored</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># all images should be downloaded</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>  <span class="c1"># transform the images to tensors</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># Print the number of samples in the loaded dataset</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of samples: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cifar10_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/site-packages/torchvision/datasets/cifar.py:65,</span> in <span class="ni">CIFAR10.__init__</span><span class="nt">(self, root, train, transform, target_transform, download)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="bp">self</span><span class="o">.</span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span>  <span class="c1"># training set or test set</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> <span class="k">if</span> <span class="n">download</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">65</span>     <span class="bp">self</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_integrity</span><span class="p">():</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Dataset not found or corrupted. You can use download=True to download it&quot;</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/site-packages/torchvision/datasets/cifar.py:139,</span> in <span class="ni">CIFAR10.download</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Files already downloaded and verified&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>     <span class="k">return</span>
<span class="ne">--&gt; </span><span class="mi">139</span> <span class="n">download_and_extract_archive</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">md5</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tgz_md5</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/site-packages/torchvision/datasets/utils.py:434,</span> in <span class="ni">download_and_extract_archive</span><span class="nt">(url, download_root, extract_root, filename, md5, remove_finished)</span>
<span class="g g-Whitespace">    </span><span class="mi">431</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">432</span>     <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">434</span> <span class="n">download_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">download_root</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">md5</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span> <span class="n">archive</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extracting </span><span class="si">{</span><span class="n">archive</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">extract_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/site-packages/torchvision/datasets/utils.py:144,</span> in <span class="ni">download_url</span><span class="nt">(url, root, filename, md5, max_redirect_hops)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading &quot;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span> <span class="n">fpath</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">144</span>     <span class="n">_urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">fpath</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span> <span class="k">except</span> <span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span>     <span class="k">if</span> <span class="n">url</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;https&quot;</span><span class="p">:</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/site-packages/torchvision/datasets/utils.py:48,</span> in <span class="ni">_urlretrieve</span><span class="nt">(url, filename, chunk_size)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="k">def</span> <span class="nf">_urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span>     <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="n">USER_AGENT</span><span class="p">}))</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">48</span>         <span class="n">_save_response_content</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">filename</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/site-packages/torchvision/datasets/utils.py:37,</span> in <span class="ni">_save_response_content</span><span class="nt">(content, destination, length)</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span> <span class="k">def</span> <span class="nf">_save_response_content</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>     <span class="n">content</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>     <span class="n">destination</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span>     <span class="n">length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span>     <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">,</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">length</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">37</span>         <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>             <span class="c1"># filter out keep-alive new chunks</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>                 <span class="k">continue</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/site-packages/torchvision/datasets/utils.py:48,</span> in <span class="ni">_urlretrieve.&lt;locals&gt;.&lt;lambda&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="k">def</span> <span class="nf">_urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span>     <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="n">USER_AGENT</span><span class="p">}))</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">48</span>         <span class="n">_save_response_content</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">filename</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/http/client.py:463,</span> in <span class="ni">HTTPResponse.read</span><span class="nt">(self, amt)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span> <span class="k">if</span> <span class="n">amt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>     <span class="c1"># Amount is given, implement using readinto</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span>     <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">463</span>     <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>     <span class="k">return</span> <span class="nb">memoryview</span><span class="p">(</span><span class="n">b</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">465</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span>     <span class="c1"># Amount is not given (unbounded read) so we must check self.length</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>     <span class="c1"># and self.chunked</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/http/client.py:507,</span> in <span class="ni">HTTPResponse.readinto</span><span class="nt">(self, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span>         <span class="n">b</span> <span class="o">=</span> <span class="nb">memoryview</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span> <span class="c1"># we do not use _safe_read() here because this may be a .will_close</span>
<span class="g g-Whitespace">    </span><span class="mi">505</span> <span class="c1"># connection, and the user is reading more bytes than will be provided</span>
<span class="g g-Whitespace">    </span><span class="mi">506</span> <span class="c1"># (for example, reading in 1k chunks)</span>
<span class="ne">--&gt; </span><span class="mi">507</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">b</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">509</span>     <span class="c1"># Ideally, we would raise IncompleteRead if the content-length</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span>     <span class="c1"># wasn&#39;t satisfied, but it might break compatibility.</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_close_conn</span><span class="p">()</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/socket.py:704,</span> in <span class="ni">SocketIO.readinto</span><span class="nt">(self, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">704</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sock</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span>     <span class="k">except</span> <span class="n">timeout</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_timeout_occurred</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/ssl.py:1242,</span> in <span class="ni">SSLSocket.recv_into</span><span class="nt">(self, buffer, nbytes, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1238</span>     <span class="k">if</span> <span class="n">flags</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1239</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1240</span>           <span class="s2">&quot;non-zero flags not allowed in calls to recv_into() on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="g g-Whitespace">   </span><span class="mi">1241</span>           <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1242</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1243</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1244</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/nma-course/lib/python3.9/ssl.py:1100,</span> in <span class="ni">SSLSocket.read</span><span class="nt">(self, len, buffer)</span>
<span class="g g-Whitespace">   </span><span class="mi">1098</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1099</span>     <span class="k">if</span> <span class="n">buffer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1100</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1101</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1102</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>We have 50,000 samples loaded. Now, lets take a look at one of them in detail. Each sample consists of an image and its corresponding label.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose a random sample</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">cifar10_data</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cifar10_data</span><span class="p">))]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Label: </span><span class="si">{</span><span class="n">cifar10_data</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image size: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Color images are modeled as 3 dimensional tensors. The first dimension corresponds to the channels (<span class="math notranslate nohighlight">\(\text{C}\)</span>) of the image (in this case we have RGB images). The second dimensions is the height (<span class="math notranslate nohighlight">\(\text{H}\)</span>) of the image and the third is the width (<span class="math notranslate nohighlight">\(\text{W}\)</span>). We can denote this image format as <span class="math notranslate nohighlight">\(\text{C} \times \text{H} \times \text{W}\)</span>.</p>
</div>
<div class="section" id="coding-exercise-2-5-display-an-image-from-the-dataset">
<h3>Coding Exercise 2.5: Display an image from the dataset<a class="headerlink" href="#coding-exercise-2-5-display-an-image-from-the-dataset" title="Permalink to this headline"></a></h3>
<p>Lets try to display the image using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. The code below will not work, because <code class="docutils literal notranslate"><span class="pre">imshow</span></code> expects to have the image in a different format, i.e., <span class="math notranslate nohighlight">\(\text{C} \times \text{H} \times \text{W}\)</span>.</p>
<p>You need to reorder the dimensions of the tensor using the <code class="docutils literal notranslate"><span class="pre">permute</span></code> method of the tensor. PyTorch <code class="docutils literal notranslate"><span class="pre">torch.permute(*dims)</span></code> rearranges the original tensor according to the desired ordering and returns a new multidimensional rotated tensor. The size of the returned tensor remains the same as that of the original.</p>
<p><strong>Code hint:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a tensor of size 2 x 4</span>
<span class="n">input_var</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1"># print its size and the tensor</span>
<span class="nb">print</span><span class="p">(</span><span class="n">input_var</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">input_var</span><span class="p">)</span>

<span class="c1"># dimensions permuted</span>
<span class="n">input_var</span> <span class="o">=</span> <span class="n">input_var</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># print its size and the permuted tensor</span>
<span class="nb">print</span><span class="p">(</span><span class="n">input_var</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">input_var</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: Uncomment the following line to see the error that arises from the current image format</span>
<span class="c1"># plt.imshow(image)</span>

<span class="c1"># TODO: Comment the above line and fix this code by reordering the tensor dimensions</span>
<span class="c1"># plt.imshow(image.permute(...))</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_b04bd357.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W1D1_BasicsAndPytorch/static/W1D1_Tutorial1_Solution_b04bd357_0.png"><img alt="Solution hint" class="align-left" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W1D1_BasicsAndPytorch/static/W1D1_Tutorial1_Solution_b04bd357_0.png" style="width: 580.0px; height: 575.0px;" /></a>
<div class="section" id="id12">
<h4>Submit your feedback<a class="headerlink" href="#id12" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Display_an_Image_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-8-train-and-test">
<h4>Video 8: Train and Test<a class="headerlink" href="#video-8-train-and-test" title="Permalink to this headline"></a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id13">
<h4>Submit your feedback<a class="headerlink" href="#id13" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Train_and_Test_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Training and Test Datasets</strong></p>
<p>When loading a dataset, you can specify if you want to load the training or the test samples using the <code class="docutils literal notranslate"><span class="pre">train</span></code> argument. We can load the training and test datasets separately. For simplicity, today we will not use both datasets separately, but this topic will be adressed in the next days.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the training samples</span>
<span class="n">training_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
    <span class="p">)</span>

<span class="c1"># Load the test samples</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-9-data-augmentation-transformations">
<h4>Video 9: Data Augmentation - Transformations<a class="headerlink" href="#video-9-data-augmentation-transformations" title="Permalink to this headline"></a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p><strong>Dataloader</strong></p>
<p>Another important concept is the <code class="docutils literal notranslate"><span class="pre">Dataloader</span></code>. It is a wrapper around the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> that splits it into minibatches (important for training the neural network) and makes the data iterable. The <code class="docutils literal notranslate"><span class="pre">shuffle</span></code> argument is used to shuffle the order of the samples across the minibatches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dataloaders with</span>
<span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em>Reproducibility:</em> DataLoader will reseed workers following Randomness in multi-process data loading algorithm. Use <code class="docutils literal notranslate"><span class="pre">worker_init_fn()</span></code> and a <code class="docutils literal notranslate"><span class="pre">generator</span></code> to preserve reproducibility:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seed_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
  <span class="n">worker_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
  <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>


<span class="n">g_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">()</span>
<span class="n">g_seed</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">my_seed</span><span class="p">)</span>

<span class="n">DataLoader</span><span class="p">(</span>
    <span class="n">train_dataset</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
    <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">seed_worker</span><span class="p">,</span>
    <span class="n">generator</span><span class="o">=</span><span class="n">g_seed</span>
    <span class="p">)</span>
</pre></div>
</div>
<p><strong>Important:</strong> For the <code class="docutils literal notranslate"><span class="pre">seed_worker</span></code> to have an effect, <code class="docutils literal notranslate"><span class="pre">num_workers</span></code> should be 2 or more.</p>
<p>We can now query the next batch from the data loader and inspect it. For this we need to convert the dataloader object to a Python iterator using the function <code class="docutils literal notranslate"><span class="pre">iter</span></code> and then we can query the next batch using the function <code class="docutils literal notranslate"><span class="pre">next</span></code>.</p>
<p>We can now see that we have a 4D tensor. This is because we have a 64 images in the batch (<span class="math notranslate nohighlight">\(B\)</span>) and each image has 3 dimensions: channels (<span class="math notranslate nohighlight">\(C\)</span>), height (<span class="math notranslate nohighlight">\(H\)</span>) and width (<span class="math notranslate nohighlight">\(W\)</span>). So, the size of the 4D tensor is <span class="math notranslate nohighlight">\(B \times C \times H \times W\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the next batch</span>
<span class="n">batch_images</span><span class="p">,</span> <span class="n">batch_labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Batch size:&#39;</span><span class="p">,</span> <span class="n">batch_images</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Display the first image from the batch</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">batch_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Transformations</strong></p>
<p>Another useful feature when loading a dataset is applying transformations on the data - color conversions, normalization, cropping, rotation etc. There are many predefined transformations in the <code class="docutils literal notranslate"><span class="pre">torchvision.transforms</span></code> package and you can also combine them using the <code class="docutils literal notranslate"><span class="pre">Compose</span></code> transform. Checkout the <a class="reference external" href="https://pytorch.org/vision/stable/transforms.html">pytorch documentation</a> for details.</p>
</div>
</div>
<div class="section" id="coding-exercise-2-6-load-the-cifar10-dataset-as-grayscale-images">
<h3>Coding Exercise 2.6: Load the CIFAR10 dataset as grayscale images<a class="headerlink" href="#coding-exercise-2-6-load-the-cifar10-dataset-as-grayscale-images" title="Permalink to this headline"></a></h3>
<p>The goal of this excercise is to load the images from the CIFAR10 dataset as grayscale images. Note that we rerun the <code class="docutils literal notranslate"><span class="pre">set_seed</span></code> function to ensure reproducibility.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_data_load</span><span class="p">():</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Function to load CIFAR10 data as grayscale images</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    data: DataFrame</span>
<span class="sd">      CIFAR10 loaded Dataframe of shape (3309, 14)</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1">###############################################</span>
  <span class="c1">## TODO for students: load the CIFAR10 data,</span>
  <span class="c1">## but as grayscale images and not as RGB colored.</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Student exercise: fill in the missing code to load the data&quot;</span><span class="p">)</span>
  <span class="c1">###############################################</span>
  <span class="c1">## TODO Load the CIFAR10 data using a transform that converts the images to grayscale tensors</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="o">...</span><span class="p">,</span>
                          <span class="n">transform</span><span class="o">=...</span><span class="p">)</span>
  <span class="c1"># Display a random grayscale image</span>
  <span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))]</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

  <span class="k">return</span> <span class="n">data</span>


<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
<span class="c1">## After implementing the above code, uncomment the following lines to test your code</span>
<span class="c1"># data = my_data_load()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_1c5a709e.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W1D1_BasicsAndPytorch/static/W1D1_Tutorial1_Solution_1c5a709e_1.png"><img alt="Solution hint" class="align-left" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W1D1_BasicsAndPytorch/static/W1D1_Tutorial1_Solution_1c5a709e_1.png" style="width: 580.0px; height: 575.0px;" /></a>
<div class="section" id="id14">
<h4>Submit your feedback<a class="headerlink" href="#id14" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Load_CIFAR10_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-3-neural-networks">
<h1>Section 3: Neural Networks<a class="headerlink" href="#section-3-neural-networks" title="Permalink to this headline"></a></h1>
<p><em>Time estimate: ~1 hour 30 mins (excluding video)</em></p>
<p>Now its time for you to create your first neural network using PyTorch. This section will walk you through the process of:</p>
<ul class="simple">
<li><p>Creating a simple neural network model</p></li>
<li><p>Training the network</p></li>
<li><p>Visualizing the results of the network</p></li>
<li><p>Tweaking the network</p></li>
</ul>
<div class="section" id="video-10-csv-files">
<h2>Video 10: CSV Files<a class="headerlink" href="#video-10-csv-files" title="Permalink to this headline"></a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id15">
<h2>Submit your feedback<a class="headerlink" href="#id15" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_CSV_files_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-1-data-loading">
<h2>Section 3.1: Data Loading<a class="headerlink" href="#section-3-1-data-loading" title="Permalink to this headline"></a></h2>
<p>First we need some sample data to train our network on. You can use the function below to generate an example dataset consisting of 2D points along two interleaving half circles. The data will be stored in a file called <code class="docutils literal notranslate"><span class="pre">sample_data.csv</span></code>. You can inspect the file directly in Colab by going to Files on the left side and opening the CSV file.</p>
<div class="section" id="generate-sample-data">
<h3>Generate sample data<a class="headerlink" href="#generate-sample-data" title="Permalink to this headline"></a></h3>
<p>we used <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> module</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Generate sample data</span>
<span class="c1"># @markdown we used `scikit-learn` module</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>

<span class="c1"># Create a dataset of 256 points with a little noise</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Store the data as a Pandas data frame and save it to a CSV file</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">x1</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;sample_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can load the data from the CSV file using the Pandas library. Pandas provides many functions for reading files in various formats. When loading data from a CSV file, we can reference the columns directly by their names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the data from the CSV file in a Pandas DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;sample_data.csv&quot;</span><span class="p">)</span>

<span class="c1"># Create a 2D numpy array from the x0 and x1 columns</span>
<span class="n">X_orig</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;x0&quot;</span><span class="p">,</span> <span class="s2">&quot;x1&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># Create a 1D numpy array from the y column</span>
<span class="n">y_orig</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># Print the sizes of the generated 2D points X and the corresponding labels Y</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Size X:</span><span class="si">{</span><span class="n">X_orig</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Size y:</span><span class="si">{</span><span class="n">y_orig</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize the dataset. The color of the points is determined by the labels `y_orig`.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_orig</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_orig</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">y_orig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Prepare Data for PyTorch</strong></p>
<p>Now lets prepare the data in a format suitable for PyTorch - convert everything into tensors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the device variable</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>

<span class="c1"># Convert the 2D points to a float32 tensor</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_orig</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Upload the tensor to the device</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Size X:</span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Convert the labels to a long interger tensor</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y_orig</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">)</span>

<span class="c1"># Upload the tensor to the device</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Size y:</span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-2-create-a-simple-neural-network">
<h2>Section 3.2: Create a Simple Neural Network<a class="headerlink" href="#section-3-2-create-a-simple-neural-network" title="Permalink to this headline"></a></h2>
<div class="section" id="video-11-generating-the-neural-network">
<h3>Video 11: Generating the Neural Network<a class="headerlink" href="#video-11-generating-the-neural-network" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id16">
<h3>Submit your feedback<a class="headerlink" href="#id16" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Generating_Neural_Network_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For this example we want to have a simple neural network consisting of 3 layers:</p>
<ul class="simple">
<li><p>1 input layer of size 2 (our points have 2 coordinates)</p></li>
<li><p>1 hidden layer of size 16 (you can play with different numbers here)</p></li>
<li><p>1 output layer of size 2 (we want the have the scores for the two classes)</p></li>
</ul>
<p>During the course you will deal with differend kinds of neural networks. On Day 2, we will focus on linear networks, but you will work with some more complicated architectures in the next days. The example here is meant to demonstrate the process of creating and training a neural network end-to-end.</p>
<p><strong>Programing the Network</strong></p>
<p>PyTorch provides a base class for all neural network modules called <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html"><code class="docutils literal notranslate"><span class="pre">nn.Module</span></code></a>. You need to inherit from <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code> and implement some important methods:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code></p>
<p>In the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method you need to define the structure of your network. Here you will specify what layers will the network consist of, what activation functions will be used etc.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code></p>
<p>All neural network modules need to implement the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method. It specifies the computations the network needs to do when data is passed through it.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict</span></code></p>
<p>This is not an obligatory method of a neural network module, but it is a good practice if you want to quickly get the most likely label from the network. It calls the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method and chooses the label with the highest score.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">train</span></code></p>
<p>This is also not an obligatory method, but it is a good practice to have. The method will be used to train the network parameters and will be implemented later in the notebook.</p>
</li>
</ul>
<br>
<p><strong>Note:</strong> You can use the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method of a module directly and it will invoke the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method: <code class="docutils literal notranslate"><span class="pre">net()</span></code> does the same as <code class="docutils literal notranslate"><span class="pre">net.forward()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inherit from nn.Module - the base class for neural network modules provided by Pytorch</span>
<span class="k">class</span> <span class="nc">NaiveNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  NaiveNet architecture</span>
<span class="sd">  Structure is as follows:</span>
<span class="sd">  Linear Layer (2, 16) -&gt; ReLU activation -&gt; Linear Layer (16, 2)</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1"># Define the structure of your network</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the NaiveNet structure by initialising following attributes</span>
<span class="sd">    nn.Linear (2, 16):  Transformation from the input to the hidden layer</span>
<span class="sd">    nn.ReLU: Activation function (ReLU) is a non-linearity which is widely used because it reduces computation.</span>
<span class="sd">             The function returns 0 if it receives any negative input, but for any positive value x, it returns that value back.</span>
<span class="sd">    nn.Linear (16, 2): Transformation from the hidden to the output layer</span>

<span class="sd">    Args:</span>
<span class="sd">      None</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">NaiveNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># The network is defined as a sequence of operations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>

  <span class="c1"># Specify the computations performed on the data</span>
  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the forward pass through the above defined structure</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.Tensor</span>
<span class="sd">        Input tensor of size ([3])</span>

<span class="sd">    Returns:</span>
<span class="sd">      layers: nn.module</span>
<span class="sd">        Initialised Layers in order to re-use the same layer for each forward pass of data you make.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Pass the data through the layers</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="c1"># Choose the most likely label predicted by the network</span>
  <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs the prediction task of the network</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.Tensor</span>
<span class="sd">        Input tensor of size ([3])</span>

<span class="sd">    Returns:</span>
<span class="sd">      Most likely class i.e., Label with the highest score</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Pass the data through the networks</span>
    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Choose the label with the highest score</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

  <span class="c1"># Train the neural network (will be implemented later)</span>
  <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Training the Neural Network</span>

<span class="sd">    Args:</span>
<span class="sd">      X: torch.Tensor</span>
<span class="sd">        Input data</span>
<span class="sd">      y: torch.Tensor</span>
<span class="sd">        Class Labels/Targets</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Check that your network works</strong></p>
<p>Create an instance of your model and visualize it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create new NaiveNet and transfer it to the device</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NaiveNet</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="c1"># Print the structure of the network</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-3-2-classify-some-samples">
<h3>Coding Exercise 3.2: Classify some samples<a class="headerlink" href="#coding-exercise-3-2-classify-some-samples" title="Permalink to this headline"></a></h3>
<p>Now, lets pass some of the points of our dataset through the network and see if it works. You should not expect the network to actually classify the points correctly, because it has not been trained yet.</p>
<p>The goal here is just to get some experience with the data structures that are passed to the forward and predict methods and their results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Get the samples</span>
<span class="c1"># X_samples = ...</span>
<span class="c1"># print(&quot;Sample input:\n&quot;, X_samples)</span>

<span class="c1">## Do a forward pass of the network</span>
<span class="c1"># output = ...</span>
<span class="c1"># print(&quot;\nNetwork output:\n&quot;, output)</span>

<span class="c1">## Predict the label of each point</span>
<span class="c1"># y_predicted = ...</span>
<span class="c1"># print(&quot;\nPredicted labels:\n&quot;, y_predicted)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_63f6a21a.py"><em>Click for solution</em></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sample</span> <span class="nb">input</span><span class="p">:</span>
 <span class="n">tensor</span><span class="p">([[</span> <span class="mf">0.9066</span><span class="p">,</span>  <span class="mf">0.5052</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.2024</span><span class="p">,</span>  <span class="mf">1.1226</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.0685</span><span class="p">,</span>  <span class="mf">0.2809</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.6720</span><span class="p">,</span>  <span class="mf">0.5097</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.8548</span><span class="p">,</span>  <span class="mf">0.5122</span><span class="p">]],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>

<span class="n">Network</span> <span class="n">output</span><span class="p">:</span>
 <span class="n">tensor</span><span class="p">([[</span> <span class="mf">0.1543</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8018</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">2.2077</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.9859</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.5745</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0195</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.1924</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8367</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.1818</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8301</span><span class="p">]],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">,</span> <span class="n">grad_fn</span><span class="o">=&lt;</span><span class="n">AddmmBackward</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">Predicted</span> <span class="n">labels</span><span class="p">:</span>
 <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id17">
<h4>Submit your feedback<a class="headerlink" href="#id17" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Classify_some_examples_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-3-train-your-neural-network">
<h2>Section 3.3: Train Your Neural Network<a class="headerlink" href="#section-3-3-train-your-neural-network" title="Permalink to this headline"></a></h2>
<div class="section" id="video-12-train-the-network">
<h3>Video 12: Train the Network<a class="headerlink" href="#video-12-train-the-network" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id18">
<h3>Submit your feedback<a class="headerlink" href="#id18" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Train_the_Network_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now it is time to train your network on your dataset. Dont worry if you dont fully understand everything yet - we will cover training in much more details in the next days. For now, the goal is just to see your network in action!</p>
<p>You will usually implement the <code class="docutils literal notranslate"><span class="pre">train</span></code> method directly when implementing your class <code class="docutils literal notranslate"><span class="pre">NaiveNet</span></code>. Here, we will implement it as a function outside of the class in order to have it in a separate cell.</p>
</div>
<div class="section" id="helper-function-to-plot-the-decision-boundary">
<h3>Helper function to plot the decision boundary<a class="headerlink" href="#helper-function-to-plot-the-decision-boundary" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper function to plot the decision boundary</span>

<span class="c1"># Code adapted from this notebook: https://jonchar.net/notebooks/Artificial-Neural-Network-with-Keras/</span>

<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span> <span class="nf">plot_decision_boundary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function to plot decision boundary</span>

<span class="sd">  Args:</span>
<span class="sd">    model: nn.module</span>
<span class="sd">      NaiveNet instance</span>
<span class="sd">    X: torch.tensor</span>
<span class="sd">      Input CIFAR10 data</span>
<span class="sd">    y: torch.tensor</span>
<span class="sd">      Class Labels/Targets</span>
<span class="sd">    device: String</span>
<span class="sd">      &quot;cpu&quot; or &quot;cuda&quot;</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c1"># Transfer the data to the CPU</span>
  <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

  <span class="c1"># Check if the frames folder exists and create it if needed</span>
  <span class="n">frames_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;frames&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">frames_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">frames_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

  <span class="c1"># Set min and max values and give it some padding</span>
  <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">.5</span>
  <span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">.5</span>
  <span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span>

  <span class="c1"># Generate a grid of points with distance h between them</span>
  <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>

  <span class="c1"># Predict the function value for the whole gid</span>
  <span class="n">grid_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]</span>
  <span class="n">grid_points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">grid_points</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">)</span>
  <span class="n">Z</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">grid_points</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">))</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
  <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

  <span class="c1"># Plot the contour and training examples</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Spectral</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implement the train function given a training dataset X and correcsponding labels y</span>
<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Training the Neural Network</span>

<span class="sd">    Args:</span>
<span class="sd">      X: torch.Tensor</span>
<span class="sd">        Input data</span>
<span class="sd">      y: torch.Tensor</span>
<span class="sd">        Class Labels/Targets</span>

<span class="sd">    Returns:</span>
<span class="sd">      losses: Float</span>
<span class="sd">        Cross Entropy Loss; Cross-entropy builds upon the idea of entropy</span>
<span class="sd">        from information theory and calculates the number of bits required</span>
<span class="sd">        to represent or transmit an average event from one distribution</span>
<span class="sd">        compared to another distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
  <span class="c1"># The Cross Entropy Loss is suitable for classification problems</span>
  <span class="n">loss_function</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>

  <span class="c1"># Create an optimizer (Stochastic Gradient Descent) that will be used to train the network</span>
  <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">1e-2</span>
  <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>

  <span class="c1"># Number of epochs</span>
  <span class="n">epochs</span> <span class="o">=</span> <span class="mi">15000</span>

  <span class="c1"># List of losses for visualization</span>
  <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="c1"># Pass the data through the network and compute the loss</span>
    <span class="c1"># We&#39;ll use the whole dataset during the training instead of using batches</span>
    <span class="c1"># in to order to keep the code simple for now.</span>
    <span class="n">y_logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_function</span><span class="p">(</span><span class="n">y_logits</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># Clear the previous gradients and compute the new ones</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

    <span class="c1"># Adapt the weights of the network</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="c1"># Store the loss</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

    <span class="c1"># Print the results at every 1000th epoch</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Epoch </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> loss is </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

      <span class="n">plot_decision_boundary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;frames/</span><span class="si">{:05d}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">losses</span>


<span class="c1"># Create a new network instance a train it</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NaiveNet</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">losses</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Plot the loss during training</strong></p>
<p>Plot the loss during the training to see how it reduces and converges.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">losses</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">losses</span><span class="p">)),</span> <span class="n">losses</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Epoch&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualize-the-training-process">
<h3>Visualize the training process<a class="headerlink" href="#visualize-the-training-process" title="Permalink to this headline"></a></h3>
<p>Execute this cell!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Visualize the training process</span>
<span class="c1"># @markdown Execute this cell!</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>imageio<span class="w"> </span>--quiet
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pathlib<span class="w"> </span>--quiet

<span class="kn">import</span> <span class="nn">imageio.v2</span> <span class="k">as</span> <span class="nn">imageio</span>
<span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>

<span class="c1"># Make a list with all images</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;frames/0&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;000.png&quot;</span><span class="p">)</span>
  <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="c1"># Save the gif</span>
<span class="n">imageio</span><span class="o">.</span><span class="n">mimsave</span><span class="p">(</span><span class="s1">&#39;frames/movie.gif&#39;</span><span class="p">,</span> <span class="n">images</span><span class="p">)</span>
<span class="n">gifPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;frames/movie.gif&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">gifPath</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-13-play-with-it">
<h3>Video 13: Play with it<a class="headerlink" href="#video-13-play-with-it" title="Permalink to this headline"></a></h3>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id19">
<h3>Submit your feedback<a class="headerlink" href="#id19" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Play_with_it_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-3-3-tweak-your-network">
<h3>Exercise 3.3: Tweak your Network<a class="headerlink" href="#exercise-3-3-tweak-your-network" title="Permalink to this headline"></a></h3>
<p>You can now play around with the network a little bit to get a feeling of what different parameters are doing. Here are some ideas what you could try:</p>
<ul class="simple">
<li><p>Increase or decrease the number of epochs for training</p></li>
<li><p>Increase or decrease the size of the hidden layer</p></li>
<li><p>Add one additional hidden layer</p></li>
</ul>
<p>Can you get the network to better fit the data?</p>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_fd3bd4a1.py"><em>Click for solution</em></a></p>
<div class="section" id="id20">
<h4>Submit your feedback<a class="headerlink" href="#id20" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Tweak_your_Network_Discussion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-14-xor-widget">
<h4>Video 14: XOR Widget<a class="headerlink" href="#video-14-xor-widget" title="Permalink to this headline"></a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id21">
<h4>Submit your feedback<a class="headerlink" href="#id21" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_XOR_widget_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Exclusive OR (XOR) logical operation gives a true (<code class="docutils literal notranslate"><span class="pre">1</span></code>) output when the number of true inputs is odd. That is, a true output result if one, and only one, of the inputs to the gate is true. If both inputs are false (<code class="docutils literal notranslate"><span class="pre">0</span></code>) or both are true or false output results. Mathematically speaking, XOR represents the inequality function, i.e., the output is true if the inputs are not alike; otherwise, the output is false.</p>
<p>In case of two inputs (<span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>) the following truth table is applied:</p>
<div class="amsmath math notranslate nohighlight" id="equation-bb38284a-6ea7-4284-a674-7cc63ad9c69e">
<span class="eqno">(7)<a class="headerlink" href="#equation-bb38284a-6ea7-4284-a674-7cc63ad9c69e" title="Permalink to this equation"></a></span>\[\begin{matrix}
  X &amp; Y &amp; \text{XOR}\\
  \hline
  0 &amp; 0 &amp; 0\\
  0 &amp; 1 &amp; 1\\
  1 &amp; 0 &amp; 1\\
  1 &amp; 1 &amp; 0
\end{matrix}\]</div>
<p>Here, with <code class="docutils literal notranslate"><span class="pre">0</span></code>, we denote <code class="docutils literal notranslate"><span class="pre">False</span></code>, and with <code class="docutils literal notranslate"><span class="pre">1</span></code> we denote <code class="docutils literal notranslate"><span class="pre">True</span></code> in boolean terms.</p>
</div>
</div>
<div class="section" id="interactive-demo-3-3-solving-xor">
<h3>Interactive Demo 3.3: Solving XOR<a class="headerlink" href="#interactive-demo-3-3-solving-xor" title="Permalink to this headline"></a></h3>
<p>Here we use an open source and famous visualization widget developed by Tensorflow team available <a class="reference external" href="https://github.com/tensorflow/playground">here</a>.</p>
<ul class="simple">
<li><p>Play with the widget and observe if you can solve the continuous XOR dataset.</p></li>
<li><p>Now add one hidden layer with three units, play with the widget, and set weights by hand to solve this dataset perfectly.</p></li>
</ul>
<p>For the second part, you should set the weights by clicking on the connections and either type the value or use the up and down keys to change it by one increment. You could also do the same for the biases by clicking on the tiny square to each neurons bottom left.
Even though there are infinitely many solutions, a neat solution when <span class="math notranslate nohighlight">\(f(x)\)</span> is ReLU is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-006ab6d1-b335-4750-96e4-ccfa5d45b7be">
<span class="eqno">(8)<a class="headerlink" href="#equation-006ab6d1-b335-4750-96e4-ccfa5d45b7be" title="Permalink to this equation"></a></span>\[\begin{equation}
  y = f(x_1)+f(x_2)-f(x_1+x_2)
\end{equation}\]</div>
<p>Try to set the weights and biases to implement this function after you played enough :)</p>
<p>Play with the parameters to solve XOR</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Do you think we can solve the discrete XOR (only 4 possibilities) with only 2 hidden units?</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Do you think we can solve the discrete XOR (only 4 possibilities) with only 2 hidden units?</span>
<span class="n">w1_min_xor</span> <span class="o">=</span> <span class="s1">&#39;Select&#39;</span> <span class="c1"># @param [&#39;Select&#39;, &#39;Yes&#39;, &#39;No&#39;]</span>
<span class="k">if</span> <span class="n">w1_min_xor</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Awesome. Indeed, yes. We take the two points for which the output should be 1 and dedicate one of the hidden units to each of them. Each of theses  ReLU functions are diagonal and tuned so that only for one of those two points the output is 1. In the end, we add these two together. And voila - discrete xor.&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">w1_min_xor</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;How about giving it another try?&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Select &#39;Yes&#39; or &#39;No&#39;!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id22">
<h4>Submit your feedback<a class="headerlink" href="#id22" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_XOR_Interactive_Demo&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-4-ethics-and-course-info">
<h1>Section 4: Ethics And Course Info<a class="headerlink" href="#section-4-ethics-and-course-info" title="Permalink to this headline"></a></h1>
<div class="section" id="video-15-ethics">
<h2>Video 15: Ethics<a class="headerlink" href="#video-15-ethics" title="Permalink to this headline"></a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id23">
<h2>Submit your feedback<a class="headerlink" href="#id23" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Ethics_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-16-be-a-group">
<h2>Video 16: Be a group<a class="headerlink" href="#video-16-be-a-group" title="Permalink to this headline"></a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id24">
<h2>Submit your feedback<a class="headerlink" href="#id24" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Be_a_group_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-17-syllabus">
<h2>Video 17: Syllabus<a class="headerlink" href="#video-17-syllabus" title="Permalink to this headline"></a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="id25">
<h2>Submit your feedback<a class="headerlink" href="#id25" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Syllabus_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="meet-our-lecturers">
<h2>Meet our lecturers<a class="headerlink" href="#meet-our-lecturers" title="Permalink to this headline"></a></h2>
<div class="section" id="week-1-the-building-blocks">
<h3>Week 1: the building blocks<a class="headerlink" href="#week-1-the-building-blocks" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://kordinglab.com">Konrad Kording</a></p></li>
<li><p><a class="reference external" href="https://www.saxelab.org/">Andrew Saxe</a></p></li>
<li><p><a class="reference external" href="https://ganguli-gang.stanford.edu/">Surya Ganguli</a></p></li>
<li><p><a class="reference external" href="http://mitliagkas.github.io/">Ioannis Mitliagkas</a></p></li>
<li><p><a class="reference external" href="https://www.cis.upenn.edu/~ungar/">Lyle Ungar</a></p></li>
</ul>
</div>
<div class="section" id="week-2-making-things-work">
<h3>Week 2: making things work<a class="headerlink" href="#week-2-making-things-work" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://webdocs.cs.ualberta.ca/~alona/">Alona Fyshe</a></p></li>
<li><p><a class="reference external" href="https://eckerlab.org/">Alexander Ecker</a></p></li>
<li><p><a class="reference external" href="https://sociology.uchicago.edu/directory/james-evans">James Evans</a></p></li>
<li><p><a class="reference external" href="https://hhexiy.github.io/">He He</a></p></li>
<li><p><a class="reference external" href="https://tnel.ucsd.edu/bio">Vikash Gilja</a> and <a class="reference external" href="https://akashgit.github.io/">Akash Srivastava</a></p></li>
</ul>
</div>
<div class="section" id="week-3-more-magic">
<h3>Week 3: more magic<a class="headerlink" href="#week-3-more-magic" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://contrastiveconvergence.net/~timothylillicrap/index.php">Tim Lillicrap</a> and <a class="reference external" href="https://www.mcgill.ca/neuro/blake-richards-phd">Blake Richards</a></p></li>
<li><p><a class="reference external" href="http://www.janexwang.com/">Jane Wang</a> and <a class="reference external" href="https://feryal.github.io/">Feryal Behbahani</a></p></li>
<li><p><a class="reference external" href="https://contrastiveconvergence.net/~timothylillicrap/index.php">Tim Lillicrap</a> and <a class="reference external" href="https://www.mcgill.ca/neuro/blake-richards-phd">Blake Richards</a></p></li>
<li><p><a class="reference external" href="https://jovo.me/">Josh Vogelstein</a> and <a class="reference external" href="https://www.vincenzolomonaco.com/">Vincenzo Lamonaco</a></p></li>
</ul>
<p>Now, go to the <a class="reference external" href="https://iclr.cc/virtual/2021/paper_vis.html">visualization of ICLR papers</a>. Read a few abstracts. Look at the various clusters. Where do you see yourself in this map?</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="daily-survey">
<h1>Daily survey<a class="headerlink" href="#daily-survey" title="Permalink to this headline"></a></h1>
<p>Dont forget to complete your reflections and content check in the daily survey! Please be patient after logging in as there is
a small delay before you will be redirected to the survey.</p>
<p><a href="https://portal.neuromatchacademy.org/api/redirect/to/f2da6480-069c-49b9-a37b-8750f9d6f359"><img alt="button link to survey" src="https://github.com/NeuromatchAcademy/course-content-dl/blob/main/tutorials/static/SurveyButton.png?raw=1" /></a></p>
</div>
<hr class="docutils" />
<div class="section" id="bonus-60-years-of-machine-learning-research-in-one-plot">
<h1>Bonus - 60 years of Machine Learning Research in one Plot<a class="headerlink" href="#bonus-60-years-of-machine-learning-research-in-one-plot" title="Permalink to this headline"></a></h1>
<p>By <a class="reference external" href="http://hendrik.strobelt.com">Hendrik Strobelt</a> (MIT-IBM Watson AI Lab) with support from Benjamin Hoover.</p>
<p>In this notebook we visualize a subset* of 3,300 articles retreived from the AllenAI <a class="reference external" href="https://github.com/allenai/s2orc">S2ORC dataset</a>. We represent each paper by a position that is output of a dimensionality reduction method applied to a vector representation of each paper. The vector representation is the output of a neural network.</p>
<p><strong>Note:</strong> The selection is very biased on the keywords and methodology we used to filter. Please see the details section to learn about what we did.</p>
<div class="section" id="install-and-import-altair-and-vega-datasets">
<h2>Install and Import <code class="docutils literal notranslate"><span class="pre">altair</span></code> and <code class="docutils literal notranslate"><span class="pre">vega_datasets</span></code>.<a class="headerlink" href="#install-and-import-altair-and-vega-datasets" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install and Import `altair` and `vega_datasets`.</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>altair<span class="w"> </span>vega_datasets<span class="w"> </span>--quiet

<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>  <span class="c1"># altair is defining data visualizations</span>

<span class="c1"># Source data files</span>
<span class="c1"># Position data file maps ID to x,y positions</span>
<span class="c1"># original link: http://gltr.io/temp/ml_regexv1_cs_ma_citation+_99perc.pos_umap_cosine_100_d0.1.json</span>
<span class="n">POS_FILE</span> <span class="o">=</span> <span class="s1">&#39;https://osf.io/qyrfn/download&#39;</span>
<span class="c1"># original link: http://gltr.io/temp/ml_regexv1_cs_ma_citation+_99perc_clean.csv</span>
<span class="c1"># Metadata file maps ID to title, abstract, author,....</span>
<span class="n">META_FILE</span> <span class="o">=</span> <span class="s1">&#39;https://osf.io/vfdu6/download&#39;</span>

<span class="c1"># data loading and wrangling</span>
<span class="k">def</span> <span class="nf">load_data</span><span class="p">():</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Loading the data</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Merged read dataFrame combining id and paper_id;</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">positions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">POS_FILE</span><span class="p">)</span>
  <span class="n">positions</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
  <span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">META_FILE</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">positions</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;paper_id&#39;</span><span class="p">)</span>


<span class="c1"># load data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="define-visualization-using-altair">
<h2>Define Visualization using ALtair<a class="headerlink" href="#define-visualization-using-altair" title="Permalink to this headline"></a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Define Visualization using ALtair</span>
<span class="n">YEAR_PERIOD</span> <span class="o">=</span> <span class="s2">&quot;quinquennial&quot;</span>  <span class="c1"># @param</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_multi</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">YEAR_PERIOD</span><span class="p">],</span> <span class="n">bind</span><span class="o">=</span><span class="s1">&#39;legend&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="n">YEAR_PERIOD</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;authors&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">YEAR_PERIOD</span><span class="p">,</span> <span class="s2">&quot;citation_count&quot;</span><span class="p">]],</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                  <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">YEAR_PERIOD</span><span class="o">+</span><span class="s1">&#39;:O&#39;</span><span class="p">,</span>
              <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1955</span><span class="p">,</span><span class="mi">2020</span><span class="p">,</span><span class="mi">5</span><span class="p">))),</span>
              <span class="c1"># legend=alt.Legend(title=&#39;Total Records&#39;)</span>
              <span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="s1">&#39;citation_count&#39;</span><span class="p">,</span>
              <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;pow&quot;</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span>
              <span class="p">),</span>
       <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;x:Q&#39;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">),</span>
       <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;y:Q&#39;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;authors&#39;</span><span class="p">],</span>
    <span class="c1"># size=&#39;citation_count&#39;,</span>
    <span class="c1"># color=&quot;decade:O&quot;,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">.8</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)),</span>

<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">selection</span>
<span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Lets look at the Visualization. Each dot represents one paper. Close dots mean that the respective papers are closer related than distant ones. The color indicates the 5-year period of when the paper was published. The dot size indicates the citation count (within S2ORC corpus) as of July 2020.</p>
<p>The view is <strong>interactive</strong> and allows for three main interactions. Try them and play around:</p>
<ol class="simple">
<li><p>Hover over a dot to see a tooltip (title, author)</p></li>
<li><p>Select a year in the legend (right) to filter dots</p></li>
<li><p>Zoom in/out with scroll  double click resets view</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="questions">
<h2>Questions<a class="headerlink" href="#questions" title="Permalink to this headline"></a></h2>
<p>By playing around, can you find some answers to the following questions?</p>
<ol class="simple">
<li><p>Can you find topical clusters? What cluster might occur because of a filtering error?</p></li>
<li><p>Can you see a temporal trend in the data and clusters?</p></li>
<li><p>Can you determine when deep learning methods started booming ?</p></li>
<li><p>Can you find the key papers that where written before the DL winter that define milestones for a cluster? (tip: look for large dots of different color)</p></li>
</ol>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main/tutorials/W1D1_BasicsAndPytorch/solutions/W1D1_Tutorial1_Solution_21a88cd0.py"><em>Click for solution</em></a></p>
<div class="section" id="id26">
<h3>Submit your feedback<a class="headerlink" href="#id26" title="Permalink to this headline"></a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Bonus_Section_Discussion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline"></a></h2>
<p>Here is what we did:</p>
<ol class="simple">
<li><p>Filtering of all papers who fullfilled the criterria:</p></li>
</ol>
<ul class="simple">
<li><p>are categorized as <code class="docutils literal notranslate"><span class="pre">Computer</span> <span class="pre">Science</span></code> or <code class="docutils literal notranslate"><span class="pre">Mathematics</span></code></p></li>
<li><p>one of the following keywords appearing in title or abstract: <code class="docutils literal notranslate"><span class="pre">&quot;machine</span> <span class="pre">learning|artificial</span> <span class="pre">intelligence|neural</span> <span class="pre">network|(machine|computer)</span> <span class="pre">vision|perceptron|network</span> <span class="pre">architecture|</span> <span class="pre">RNN</span> <span class="pre">|</span> <span class="pre">CNN</span> <span class="pre">|</span> <span class="pre">LSTM</span> <span class="pre">|</span> <span class="pre">BLEU</span> <span class="pre">|</span> <span class="pre">MNIST</span> <span class="pre">|</span> <span class="pre">CIFAR</span> <span class="pre">|reinforcement</span> <span class="pre">learning|gradient</span> <span class="pre">descent|</span> <span class="pre">Imagenet</span> <span class="pre">&quot;</span></code></p></li>
</ul>
<ol class="simple">
<li><p>Per year, remove all papers that are below the 99 percentile of citation count in that year</p></li>
<li><p>Embed each paper by using abstract + title in SPECTER model</p></li>
<li><p>Project based on embedding using UMAP</p></li>
<li><p>Visualize using Altair</p></li>
</ol>
<div class="section" id="find-authors">
<h3>Find Authors<a class="headerlink" href="#find-authors" title="Permalink to this headline"></a></h3>
<div class="section" id="edit-the-author-filter-variable-to-full-text-search-for-authors">
<h4>Edit the <code class="docutils literal notranslate"><span class="pre">AUTHOR_FILTER</span></code> variable to full text search for authors.<a class="headerlink" href="#edit-the-author-filter-variable-to-full-text-search-for-authors" title="Permalink to this headline"></a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Edit the `AUTHOR_FILTER` variable to full text search for authors.</span>

<span class="n">AUTHOR_FILTER</span> <span class="o">=</span> <span class="s2">&quot;Rush &quot;</span>  <span class="c1"># @param space at the end means &quot;word border&quot;</span>

<span class="c1">### Don&#39;t ignore case when searching...</span>
<span class="n">FLAGS</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">### uncomment do ignore case</span>
<span class="c1"># FLAGS = re.IGNORECASE</span>

<span class="c1">## --- FILTER CODE.. make it your own ---</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;issel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;authors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">AUTHOR_FILTER</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="p">)</span>
<span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;issel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.0000000001</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No match found&#39;</span><span class="p">)</span>

<span class="c1">## --- FROM HERE ON VIS CODE ---</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;authors&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">YEAR_PERIOD</span><span class="p">,</span> <span class="s2">&quot;citation_count&quot;</span><span class="p">,</span> <span class="s2">&quot;issel&quot;</span><span class="p">]],</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                  <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">strokeOpacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">YEAR_PERIOD</span><span class="o">+</span><span class="s1">&#39;:O&#39;</span><span class="p">,</span>
              <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
              <span class="c1"># legend=alt.Legend(title=&#39;Total Records&#39;)</span>
              <span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="s1">&#39;citation_count&#39;</span><span class="p">,</span>
              <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;pow&quot;</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span>
              <span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">StrokeWidth</span><span class="p">(</span><span class="s1">&#39;issel:Q&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>

    <span class="n">alt</span><span class="o">.</span><span class="n">Opacity</span><span class="p">(</span><span class="s1">&#39;issel:Q&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mf">.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;x:Q&#39;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;y:Q&#39;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;authors&#39;</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="appendix">
<h1>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline"></a></h1>
<div class="section" id="official-pytorch-resources">
<h2>Official PyTorch resources:<a class="headerlink" href="#official-pytorch-resources" title="Permalink to this headline"></a></h2>
<div class="section" id="tutorials">
<h3>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://pytorch.org/tutorials/">https://pytorch.org/tutorials/</a></p></li>
</ul>
</div>
<div class="section" id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html">https://pytorch.org/docs/stable/tensors.html</a> (tensor methods)</p></li>
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.view.html#torch.Tensor.view">https://pytorch.org/docs/stable/generated/torch.Tensor.view.html#torch.Tensor.view</a> (The view method in particular)</p></li>
<li><p><a class="reference external" href="https://pytorch.org/vision/stable/datasets.html">https://pytorch.org/vision/stable/datasets.html</a> (pre-loaded image datasets)</p></li>
</ul>
</div>
</div>
<div class="section" id="google-colab-resources">
<h2>Google Colab Resources:<a class="headerlink" href="#google-colab-resources" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://research.google.com/colaboratory/faq.html">https://research.google.com/colaboratory/faq.html</a> (FAQ including guidance on GPU usage)</p></li>
</ul>
</div>
<div class="section" id="books-for-reference">
<h2>Books for reference:<a class="headerlink" href="#books-for-reference" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.deeplearningbook.org/">https://www.deeplearningbook.org/</a> (Deep Learning by Ian Goodfellow, Yoshua Bengio and Aaron Courville)</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W1D1_BasicsAndPytorch/student"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../chapter_title.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Basics And Pytorch</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../W1D2_LinearDeepLearning/chapter_title.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Linear Deep Learning</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Neuromatch<br/>
  
    <div class="extra_footer">
      <div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"></a>
The contents of this repository are shared under under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>